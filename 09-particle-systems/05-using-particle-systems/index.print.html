




  
	
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.128.0">
    <meta name="generator" content="Relearn 6.0.0">
    <meta name="description" content="Now that we’ve defined some example particle systems, let’s see how we can put them into use.
Adding Rain Let’s start with our RainParticleSystem, and add rain that runs down the screen. Since we don’t need to start/stop the rain for this simple example, all we need to do is construct the particle system and add it to the Game.Components list in the Game.Initialize() method:
RainParticleSystem rain = new RainParticleSystem(this, new Rectangle(100, -10, 500, 10)); Components.">
    <meta name="author" content="Nathan Bean">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Using Particle Systems :: K-State CIS 580 Textbook">
    <meta name="twitter:description" content="Now that we’ve defined some example particle systems, let’s see how we can put them into use.
Adding Rain Let’s start with our RainParticleSystem, and add rain that runs down the screen. Since we don’t need to start/stop the rain for this simple example, all we need to do is construct the particle system and add it to the Game.Components list in the Game.Initialize() method:
RainParticleSystem rain = new RainParticleSystem(this, new Rectangle(100, -10, 500, 10)); Components.">
    <meta property="og:url" content="https://textbooks.cs.ksu.edu/cis580/09-particle-systems/05-using-particle-systems/">
    <meta property="og:site_name" content="K-State CIS 580 Textbook">
    <meta property="og:title" content="Using Particle Systems :: K-State CIS 580 Textbook">
    <meta property="og:description" content="Now that we’ve defined some example particle systems, let’s see how we can put them into use.
Adding Rain Let’s start with our RainParticleSystem, and add rain that runs down the screen. Since we don’t need to start/stop the rain for this simple example, all we need to do is construct the particle system and add it to the Game.Components list in the Game.Initialize() method:
RainParticleSystem rain = new RainParticleSystem(this, new Rectangle(100, -10, 500, 10)); Components.">
    <meta property="og:locale" content="en-us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Particle Systems">
    <meta property="article:published_time" content="2020-03-20T10:53:05-05:00">
    <meta property="article:modified_time" content="2021-03-31T13:14:16-05:00">
    <meta itemprop="name" content="Using Particle Systems :: K-State CIS 580 Textbook">
    <meta itemprop="description" content="Now that we’ve defined some example particle systems, let’s see how we can put them into use.
Adding Rain Let’s start with our RainParticleSystem, and add rain that runs down the screen. Since we don’t need to start/stop the rain for this simple example, all we need to do is construct the particle system and add it to the Game.Components list in the Game.Initialize() method:
RainParticleSystem rain = new RainParticleSystem(this, new Rectangle(100, -10, 500, 10)); Components.">
    <meta itemprop="datePublished" content="2020-03-20T10:53:05-05:00">
    <meta itemprop="dateModified" content="2021-03-31T13:14:16-05:00">
    <meta itemprop="wordCount" content="396">
    <title>Using Particle Systems :: K-State CIS 580 Textbook</title>
    <link href="https://textbooks.cs.ksu.edu/cis580/09-particle-systems/05-using-particle-systems/" rel="canonical" type="text/html" title="Using Particle Systems :: K-State CIS 580 Textbook">
    <link href="/cis580/09-particle-systems/05-using-particle-systems/index.xml" rel="alternate" type="application/rss+xml" title="Using Particle Systems :: K-State CIS 580 Textbook">
    <link href="/cis580/09-particle-systems/05-using-particle-systems/tele.html" rel="alternate" type="text/html" title="Using Particle Systems :: K-State CIS 580 Textbook">
    <link href="/cis580/09-particle-systems/05-using-particle-systems/embed.html" rel="alternate" type="text/html" title="Using Particle Systems :: K-State CIS 580 Textbook">
    <link href="/cis580/css/fontawesome-all.min.css?1737133120" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/cis580/css/fontawesome-all.min.css?1737133120" rel="stylesheet"></noscript>
    <link href="/cis580/css/nucleus.css?1737133120" rel="stylesheet">
    <link href="/cis580/css/auto-complete.css?1737133120" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/cis580/css/auto-complete.css?1737133120" rel="stylesheet"></noscript>
    <link href="/cis580/css/perfect-scrollbar.min.css?1737133120" rel="stylesheet">
    <link href="/cis580/css/fonts.css?1737133120" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/cis580/css/fonts.css?1737133120" rel="stylesheet"></noscript>
    <link href="/cis580/css/theme.css?1737133120" rel="stylesheet">
    <link href="/cis580/css/theme-auto.css?1737133120" rel="stylesheet" id="R-variant-style">
    <link href="/cis580/css/chroma-auto.css?1737133120" rel="stylesheet" id="R-variant-chroma-style">
    <link href="/cis580/css/variant.css?1737133120" rel="stylesheet">
    <link href="/cis580/css/print.css?1737133120" rel="stylesheet" media="print">
    <link href="/cis580/css/format-print.css?1737133120" rel="stylesheet">
    <script src="/cis580/js/variant.js?1737133120"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='..\/..';
      window.relearn.relBaseUri='..\/..\/..';
      window.relearn.absBaseUri='https:\/\/textbooks.cs.ksu.edu\/cis580';
      window.index_js_url="/cis580/index.search.js";
      // variant stuff
      window.variants && variants.init( [ 'auto', 'light-theme', 'dark-theme' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script>
    
    <link href="/cis580/css/custom.css?1737133120" rel="stylesheet">
  </head>
  <body class="mobile-support print disableInlineCopyToClipboard" data-url="/cis580/09-particle-systems/05-using-particle-systems/">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/cis580/09-particle-systems/"><span itemprop="name">Particle Systems</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">Using Particle Systems</span><meta itemprop="position" content="2"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/cis580/09-particle-systems/04-example-particle-systems/" title="Example Particle Systems (🡐)"><i class="fa-fw fas fa-chevron-left"></i></a>
            </div>
            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/cis580/09-particle-systems/06-summary/" title="Refactoring as a Game Component (🡒)"><i class="fa-fw fas fa-chevron-right"></i></a>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>

<h1 id="using-particle-systems">Using Particle Systems</h1>

<p>Now that we&rsquo;ve defined some example particle systems, let&rsquo;s see how we can put them into use.</p>
<h3 id="adding-rain">Adding Rain</h3>
<p>Let&rsquo;s start with our <code>RainParticleSystem</code>, and add rain that runs down the screen.  Since we don&rsquo;t need to start/stop the rain for this simple example, all we need to do is construct the particle system and add it to the <code>Game.Components</code> list in the <code>Game.Initialize()</code> method:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="n">RainParticleSystem</span> <span class="n">rain</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RainParticleSystem</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">new</span> <span class="n">Rectangle</span><span class="p">(</span><span class="m">100</span><span class="p">,</span> <span class="p">-</span><span class="m">10</span><span class="p">,</span> <span class="m">500</span><span class="p">,</span> <span class="m">10</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="n">Components</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">rain</span><span class="p">);</span></span></span></code></pre></div>
  
  
<div class="box notices cstyle hint">
  <div class="box-label"></div>
  <div class="box-content">

<p>Because the <code>ExplosionParticleSystem</code> inherits from <code>DrawableGameComponent</code>, we can add it to the <code>Game.Components</code> list.  This means the game will automatically call its <code>LoadContent()</code>, <code>Update()</code> and <code>Draw()</code> methods for us.  We could instead not add it to the components list, and manually invoke these ourselves.</p>
</div>
</div>
<h3 id="adding-explosions">Adding Explosions</h3>
<p>Let&rsquo;s say we want an explosion to appear on-screen wherever we click our mouse.  We&rsquo;ll use the <code>ExplosionParticleSystem</code> from the previous section to accomplish this.</p>
<p>First, because we will need to access this system in multiple methods of <code>Game</code> we&rsquo;ll need to create a field to represent it in our <code>Game</code> class.  We&rsquo;ll also want to keep track of the previous mouse state:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="n">ExplosionParticleSystem</span> <span class="n">explosions</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">MouseState</span> <span class="n">oldMouseState</span><span class="p">;</span></span></span></code></pre></div><p>And initialize it in our <code>Game.Initialize()</code> method:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="n">explosions</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ExplosionParticleSystem</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="m">20</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">Components</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">explosions</span><span class="p">);</span></span></span></code></pre></div><p>We set the particle system to use up to 20 explosions on-screen at a time (as it takes about a second for an explosion to finish, this is probably more than enough, unless we have a very explosive game).</p>
<p>Next, we add some logic to our <code>Update()</code> method to update the mouse state, and determine if we need to place an explosion:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="n">MouseState</span> <span class="n">newMouseState</span> <span class="p">=</span> <span class="n">Mouse</span><span class="p">.</span><span class="n">GetState</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">Vector2</span> <span class="n">mousePosition</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">mouseState</span><span class="p">.</span><span class="n">X</span><span class="p">,</span> <span class="n">mouseState</span><span class="p">.</span><span class="n">Y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">newMouseState</span><span class="p">.</span><span class="n">Left</span> <span class="p">==</span> <span class="n">ButtonState</span><span class="p">.</span><span class="n">Down</span> <span class="p">&amp;&amp;</span> <span class="n">oldMouseState</span><span class="p">.</span><span class="n">Left</span> <span class="p">==</span> <span class="n">ButtonState</span><span class="p">.</span><span class="n">Up</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">explosions</span><span class="p">.</span><span class="n">PlaceExplosion</span><span class="p">(</span><span class="n">mousePosition</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span></span></span></code></pre></div><p>Now, whenever we click our mouse, we&rsquo;ll see an explosion spawn!</p>
<h3 id="adding-a-pixie">Adding a Pixie</h3>
<p>Rather than declare a class to represent the mouse and go through that effort, let&rsquo;s just implement the <code>IParticleEmitter</code> interface directly on our <code>Game</code>.  Thus, we need to implement <code>Position</code> and <code>Velocity</code> properties:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">Vector2</span> <span class="n">Position</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">Vector2</span> <span class="n">Velocity</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span></span></span></code></pre></div><p>We&rsquo;ll set these in the <code>Game.Update()</code> method, based on our mouse state:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="n">Velocity</span> <span class="p">=</span> <span class="n">mousePosition</span> <span class="p">-</span> <span class="n">Position</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Position</span> <span class="p">=</span> <span class="n">mousePosition</span><span class="p">;</span></span></span></code></pre></div><p>And we&rsquo;ll need to add the particle system in the <code>Game.Initialize()</code> method, and set its emitter to the <code>Game</code> instance:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="n">PixieParticleSystem</span> <span class="n">pixie</span> <span class="p">=</span> <span class="k">new</span> <span class="n">PixieParticleSystem</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">Components</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">pixie</span><span class="p">);</span></span></span></code></pre></div><p>Now the mouse should start dripping a trail of sparks!</p>

            <footer class="footline">
              
              
              
              
            </footer>
          </article>

        </div>
      </main>
    
<div class="git-footer">
  <p class="theme-version-footer">6.0.0</p>
  <p>Last modified by: 
              <i class='fas fa-user'></i> Nathan Bean
              <i class='fas fa-calendar'></i> <a href="https://github.com/ksu-cs-textbooks/cis580/commit/d99e64bf8b59ec9d0a652c21e2c84da98a12b81e">Mar 31, 2021</a>
  </p>
  </div>
  
    
    </div>
    <script src="/cis580/js/clipboard.min.js?1737133120" defer></script>
    <script src="/cis580/js/perfect-scrollbar.min.js?1737133120" defer></script>
    <script src="/cis580/js/theme.js?1737133120" defer></script>
  </body>
</html>
