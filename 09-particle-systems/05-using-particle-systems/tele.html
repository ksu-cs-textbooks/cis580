<!DOCTYPE html>

<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article" data-r-output-format="html">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.128.0">
    <meta name="generator" content="Relearn 8.0.0">
    <meta name="description" content="Now that we’ve defined some example particle systems, let’s see how we can put them into use.
Adding Rain Let’s start with our RainParticleSystem, and add rain that runs down the screen. Since we don’t need to start/stop the rain for this simple example, all we need to do is construct the particle system and add it to the Game.Components list in the Game.Initialize() method:
RainParticleSystem rain = new RainParticleSystem(this, new Rectangle(100, -10, 500, 10)); Components.">
    <meta name="author" content="Nathan H. Bean">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://textbooks.cs.ksu.edu/cis580/images/hero.png">
    <meta name="twitter:title" content="Using Particle Systems :: K-State CIS 580 Textbook">
    <meta name="twitter:description" content="Now that we’ve defined some example particle systems, let’s see how we can put them into use.
Adding Rain Let’s start with our RainParticleSystem, and add rain that runs down the screen. Since we don’t need to start/stop the rain for this simple example, all we need to do is construct the particle system and add it to the Game.Components list in the Game.Initialize() method:
RainParticleSystem rain = new RainParticleSystem(this, new Rectangle(100, -10, 500, 10)); Components.">
    <meta property="og:url" content="https://textbooks.cs.ksu.edu/cis580/09-particle-systems/05-using-particle-systems/index.html">
    <meta property="og:site_name" content="K-State CIS 580 Textbook">
    <meta property="og:title" content="Using Particle Systems :: K-State CIS 580 Textbook">
    <meta property="og:description" content="Now that we’ve defined some example particle systems, let’s see how we can put them into use.
Adding Rain Let’s start with our RainParticleSystem, and add rain that runs down the screen. Since we don’t need to start/stop the rain for this simple example, all we need to do is construct the particle system and add it to the Game.Components list in the Game.Initialize() method:
RainParticleSystem rain = new RainParticleSystem(this, new Rectangle(100, -10, 500, 10)); Components.">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Particle Systems">
    <meta property="article:published_time" content="2020-03-20T10:53:05-05:00">
    <meta property="article:modified_time" content="2021-03-31T13:14:16-05:00">
    <meta property="og:image" content="https://textbooks.cs.ksu.edu/cis580/images/hero.png">
    <meta itemprop="name" content="Using Particle Systems :: K-State CIS 580 Textbook">
    <meta itemprop="description" content="Now that we’ve defined some example particle systems, let’s see how we can put them into use.
Adding Rain Let’s start with our RainParticleSystem, and add rain that runs down the screen. Since we don’t need to start/stop the rain for this simple example, all we need to do is construct the particle system and add it to the Game.Components list in the Game.Initialize() method:
RainParticleSystem rain = new RainParticleSystem(this, new Rectangle(100, -10, 500, 10)); Components.">
    <meta itemprop="datePublished" content="2020-03-20T10:53:05-05:00">
    <meta itemprop="dateModified" content="2021-03-31T13:14:16-05:00">
    <meta itemprop="wordCount" content="403">
    <meta itemprop="image" content="https://textbooks.cs.ksu.edu/cis580/images/hero.png">
    <title>Using Particle Systems :: K-State CIS 580 Textbook</title>
    <link href="https://textbooks.cs.ksu.edu/cis580/09-particle-systems/05-using-particle-systems/index.html" rel="canonical" type="text/html" title="Using Particle Systems :: K-State CIS 580 Textbook">
    <link href="/cis580/09-particle-systems/05-using-particle-systems/index.xml" rel="alternate" type="application/rss+xml" title="Using Particle Systems :: K-State CIS 580 Textbook">
    <link href="/cis580/09-particle-systems/05-using-particle-systems/index.print.html" rel="alternate" type="text/html" title="Using Particle Systems :: K-State CIS 580 Textbook">
    <link href="/cis580/09-particle-systems/05-using-particle-systems/embed.html" rel="alternate" type="text/html" title="Using Particle Systems :: K-State CIS 580 Textbook">
    <link href="/cis580/css/auto-complete/auto-complete.min.css?1756153111" rel="stylesheet">
    <script src="/cis580/js/auto-complete/auto-complete.min.js?1756153111" defer></script>
    <script src="/cis580/js/search-lunr.min.js?1756153111" defer></script>
    <script src="/cis580/js/search.min.js?1756153111" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.index_js_url="/cis580/searchindex.en.js?1756153111";
    </script>
    <script src="/cis580/js/lunr/lunr.min.js?1756153111" defer></script>
    <script src="/cis580/js/lunr/lunr.stemmer.support.min.js?1756153111" defer></script>
    <script src="/cis580/js/lunr/lunr.multi.min.js?1756153111" defer></script>
    <script src="/cis580/js/lunr/lunr.en.min.js?1756153111" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.contentLangs=['en'];
    </script>
    <link href="/cis580/fonts/fontawesome/css/fontawesome-all.min.css?1756153111" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/cis580/fonts/fontawesome/css/fontawesome-all.min.css?1756153111" rel="stylesheet"></noscript>
    <link href="/cis580/css/perfect-scrollbar/perfect-scrollbar.min.css?1756153111" rel="stylesheet">
    <link href="/cis580/css/theme.min.css?1756153111" rel="stylesheet">
    <link href="/cis580/css/format-html.min.css?1756153111" rel="stylesheet" id="R-format-style">
    <script>
      window.relearn = window.relearn || {};
      // configuration
      window.relearn.min = `.min`;
      window.relearn.path='\/09-particle-systems\/05-using-particle-systems\/index.html';
      window.relearn.relBasePath='..\/..';
      window.relearn.relBaseUri='..\/..\/..';
      window.relearn.absBaseUri='https:\/\/textbooks.cs.ksu.edu\/cis580';
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      window.relearn.disableInlineCopyToClipboard=true;
      window.relearn.enableBlockCodeWrap=false;
      // legal
      window.relearn.getItem = (s,n) => {return s.getItem(n)};
      window.relearn.setItem = (s,n,v) => {return s.setItem(n,v)};
      window.relearn.removeItem = (s,n) => {return s.removeItem(n)};
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
      // variant stuff
      window.relearn.themevariants = [ 'light-theme' ];
      window.relearn.customvariantname = "my-custom-variant";
      // [x] russfeld
      window.relearn.writeVariant=false;
      window.relearn.changeVariant = function(variant) {
        var oldVariant = document.documentElement.dataset.rThemeVariant;
        window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        document.documentElement.dataset.rThemeVariant = variant;
        if (oldVariant != variant) {
          document.dispatchEvent( new CustomEvent('themeVariantLoaded', { detail: { variant, oldVariant } }) );
          window.relearn.markVariant();
        }
      }
      window.relearn.markVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant");
        document.querySelectorAll(".R-variantswitcher select").forEach((select) => {select.value = variant;});
      }
      window.relearn.initVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant") ?? "";
        if( variant == window.relearn.customvariantname ){
        }else if( !variant || !window.relearn.themevariants.includes(variant) ){
          variant = window.relearn.themevariants[0];
          
          if (window.relearn.writeVariant) {
            window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
          }
        }
        document.documentElement.dataset.rThemeVariant = variant;
      }
      window.relearn.initVariant();
      window.relearn.markVariant();
    </script>
    <link href="/cis580/css/custom.css?1756153111" rel="stylesheet">
  </head>
  <body class="mobile-support html" data-url="/cis580/09-particle-systems/05-using-particle-systems/index.html">
    
    <div id="tele" class="tele mirror">
    
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      
      
      
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable 09-particle-systems" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>

<h1 id="using-particle-systems">Using Particle Systems</h1>

<p>Now that we&rsquo;ve defined some example particle systems, let&rsquo;s see how we can put them into use.</p>
<h3 id="adding-rain">Adding Rain</h3>
<p>Let&rsquo;s start with our <code>RainParticleSystem</code>, and add rain that runs down the screen.  Since we don&rsquo;t need to start/stop the rain for this simple example, all we need to do is construct the particle system and add it to the <code>Game.Components</code> list in the <code>Game.Initialize()</code> method:</p>
<div class="highlight" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    RainParticleSystem rain = <span style="color:#66d9ef">new</span> RainParticleSystem(<span style="color:#66d9ef">this</span>, <span style="color:#66d9ef">new</span> Rectangle(<span style="color:#ae81ff">100</span>, -<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">500</span>, <span style="color:#ae81ff">10</span>));
</span></span><span style="display:flex;"><span>    Components.Add(rain);</span></span></code></pre></div>

<details open class=" box cstyle notices " style=";--VARIABLE-BOX-color: hint">
  <summary class="box-label a11y-only" tabindex="-1">
    <span class="a11y-only">Details</span>
  </summary>
  <div class="box-content">
<p>Because the <code>ExplosionParticleSystem</code> inherits from <code>DrawableGameComponent</code>, we can add it to the <code>Game.Components</code> list.  This means the game will automatically call its <code>LoadContent()</code>, <code>Update()</code> and <code>Draw()</code> methods for us.  We could instead not add it to the components list, and manually invoke these ourselves.</p>
  </div>
</details>
<h3 id="adding-explosions">Adding Explosions</h3>
<p>Let&rsquo;s say we want an explosion to appear on-screen wherever we click our mouse.  We&rsquo;ll use the <code>ExplosionParticleSystem</code> from the previous section to accomplish this.</p>
<p>First, because we will need to access this system in multiple methods of <code>Game</code> we&rsquo;ll need to create a field to represent it in our <code>Game</code> class.  We&rsquo;ll also want to keep track of the previous mouse state:</p>
<div class="highlight" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    ExplosionParticleSystem explosions;
</span></span><span style="display:flex;"><span>    MouseState oldMouseState;</span></span></code></pre></div>
<p>And initialize it in our <code>Game.Initialize()</code> method:</p>
<div class="highlight" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    explosions = <span style="color:#66d9ef">new</span> ExplosionParticleSystem(<span style="color:#66d9ef">this</span>, <span style="color:#ae81ff">20</span>);
</span></span><span style="display:flex;"><span>    Components.Add(explosions);</span></span></code></pre></div>
<p>We set the particle system to use up to 20 explosions on-screen at a time (as it takes about a second for an explosion to finish, this is probably more than enough, unless we have a very explosive game).</p>
<p>Next, we add some logic to our <code>Update()</code> method to update the mouse state, and determine if we need to place an explosion:</p>
<div class="highlight" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    MouseState newMouseState = Mouse.GetState();
</span></span><span style="display:flex;"><span>    Vector2 mousePosition = <span style="color:#66d9ef">new</span> Vector2(mouseState.X, mouseState.Y);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(newMouseState.Left == ButtonState.Down &amp;&amp; oldMouseState.Left == ButtonState.Up) 
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        explosions.PlaceExplosion(mousePosition);
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div>
<p>Now, whenever we click our mouse, we&rsquo;ll see an explosion spawn!</p>
<h3 id="adding-a-pixie">Adding a Pixie</h3>
<p>Rather than declare a class to represent the mouse and go through that effort, let&rsquo;s just implement the <code>IParticleEmitter</code> interface directly on our <code>Game</code>.  Thus, we need to implement <code>Position</code> and <code>Velocity</code> properties:</p>
<div class="highlight" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Vector2 Position { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Vector2 Velocity { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }</span></span></code></pre></div>
<p>We&rsquo;ll set these in the <code>Game.Update()</code> method, based on our mouse state:</p>
<div class="highlight" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    Velocity = mousePosition - Position;
</span></span><span style="display:flex;"><span>    Position = mousePosition;</span></span></code></pre></div>
<p>And we&rsquo;ll need to add the particle system in the <code>Game.Initialize()</code> method, and set its emitter to the <code>Game</code> instance:</p>
<div class="highlight" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    PixieParticleSystem pixie = <span style="color:#66d9ef">new</span> PixieParticleSystem(<span style="color:#66d9ef">this</span>, <span style="color:#66d9ef">this</span>);
</span></span><span style="display:flex;"><span>    Components.Add(pixie);</span></span></code></pre></div>
<p>Now the mouse should start dripping a trail of sparks!</p>

  <footer class="footline">
  </footer>
</article>
        </div>
      </main>
      
      
      
    </div>
    <script src="/cis580/js/clipboard/clipboard.min.js?1756153111" defer></script>
    <script src="/cis580/js/perfect-scrollbar/perfect-scrollbar.min.js?1756153111" defer></script>
    <script src="/cis580/js/theme.min.js?1756153111" defer></script>
      
      
      
    </div> 
  <script src="/cis580/js/tele-scroll.min.js?1756153111" defer></script>
  </body>
</html>
