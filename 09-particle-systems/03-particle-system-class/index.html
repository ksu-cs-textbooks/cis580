<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article" data-r-output-format="html">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.128.0">
    <meta name="generator" content="Relearn 8.0.0">
    <meta name="description" content="The next part of the particle system is the class representing the particle system itself. Like any other sprite-based strategy, this will involve both an Update() and Draw() method that must be invoked every time through the game loop. But ideally we’d like our particle systems to be an almost hands-off system - once it’s created, we can just let it do its thing without intervention. This is where the idea of game components from our architecture discussion can come into play - our particle system can inherit from the DrawableGameComponent class, which means it can be added to to our Game.">
    <meta name="author" content="Nathan H. Bean">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://textbooks.cs.ksu.edu/cis580/images/hero.png">
    <meta name="twitter:title" content="The Particle System Class :: K-State CIS 580 Textbook">
    <meta name="twitter:description" content="The next part of the particle system is the class representing the particle system itself. Like any other sprite-based strategy, this will involve both an Update() and Draw() method that must be invoked every time through the game loop. But ideally we’d like our particle systems to be an almost hands-off system - once it’s created, we can just let it do its thing without intervention. This is where the idea of game components from our architecture discussion can come into play - our particle system can inherit from the DrawableGameComponent class, which means it can be added to to our Game.">
    <meta property="og:url" content="https://textbooks.cs.ksu.edu/cis580/09-particle-systems/03-particle-system-class/index.html">
    <meta property="og:site_name" content="K-State CIS 580 Textbook">
    <meta property="og:title" content="The Particle System Class :: K-State CIS 580 Textbook">
    <meta property="og:description" content="The next part of the particle system is the class representing the particle system itself. Like any other sprite-based strategy, this will involve both an Update() and Draw() method that must be invoked every time through the game loop. But ideally we’d like our particle systems to be an almost hands-off system - once it’s created, we can just let it do its thing without intervention. This is where the idea of game components from our architecture discussion can come into play - our particle system can inherit from the DrawableGameComponent class, which means it can be added to to our Game.">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Particle Systems">
    <meta property="article:published_time" content="2020-03-20T10:53:05-05:00">
    <meta property="article:modified_time" content="2021-03-31T13:14:16-05:00">
    <meta property="og:image" content="https://textbooks.cs.ksu.edu/cis580/images/hero.png">
    <meta itemprop="name" content="The Particle System Class :: K-State CIS 580 Textbook">
    <meta itemprop="description" content="The next part of the particle system is the class representing the particle system itself. Like any other sprite-based strategy, this will involve both an Update() and Draw() method that must be invoked every time through the game loop. But ideally we’d like our particle systems to be an almost hands-off system - once it’s created, we can just let it do its thing without intervention. This is where the idea of game components from our architecture discussion can come into play - our particle system can inherit from the DrawableGameComponent class, which means it can be added to to our Game.">
    <meta itemprop="datePublished" content="2020-03-20T10:53:05-05:00">
    <meta itemprop="dateModified" content="2021-03-31T13:14:16-05:00">
    <meta itemprop="wordCount" content="2390">
    <meta itemprop="image" content="https://textbooks.cs.ksu.edu/cis580/images/hero.png">
    <title>The Particle System Class :: K-State CIS 580 Textbook</title>
    <link href="/cis580/09-particle-systems/03-particle-system-class/index.xml" rel="alternate" type="application/rss+xml" title="The Particle System Class :: K-State CIS 580 Textbook">
    <link href="/cis580/09-particle-systems/03-particle-system-class/index.print.html" rel="alternate" type="text/html" title="The Particle System Class :: K-State CIS 580 Textbook">
    <link href="/cis580/09-particle-systems/03-particle-system-class/tele.html" rel="alternate" type="text/html" title="The Particle System Class :: K-State CIS 580 Textbook">
    <link href="/cis580/09-particle-systems/03-particle-system-class/embed.html" rel="alternate" type="text/html" title="The Particle System Class :: K-State CIS 580 Textbook">
    <link href="/cis580/css/auto-complete/auto-complete.min.css?1755628803" rel="stylesheet">
    <script src="/cis580/js/auto-complete/auto-complete.min.js?1755628803" defer></script>
    <script src="/cis580/js/search-lunr.min.js?1755628803" defer></script>
    <script src="/cis580/js/search.min.js?1755628803" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.index_js_url="/cis580/searchindex.en.js?1755628803";
    </script>
    <script src="/cis580/js/lunr/lunr.min.js?1755628803" defer></script>
    <script src="/cis580/js/lunr/lunr.stemmer.support.min.js?1755628803" defer></script>
    <script src="/cis580/js/lunr/lunr.multi.min.js?1755628803" defer></script>
    <script src="/cis580/js/lunr/lunr.en.min.js?1755628803" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.contentLangs=['en'];
    </script>
    <link href="/cis580/fonts/fontawesome/css/fontawesome-all.min.css?1755628803" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/cis580/fonts/fontawesome/css/fontawesome-all.min.css?1755628803" rel="stylesheet"></noscript>
    <link href="/cis580/css/perfect-scrollbar/perfect-scrollbar.min.css?1755628803" rel="stylesheet">
    <link href="/cis580/css/theme.min.css?1755628803" rel="stylesheet">
    <link href="/cis580/css/format-html.min.css?1755628803" rel="stylesheet" id="R-format-style">
    <script>
      window.relearn = window.relearn || {};
      // configuration
      window.relearn.min = `.min`;
      window.relearn.path='\/09-particle-systems\/03-particle-system-class\/index.html';
      window.relearn.relBasePath='..\/..';
      window.relearn.relBaseUri='..\/..\/..';
      window.relearn.absBaseUri='https:\/\/textbooks.cs.ksu.edu\/cis580';
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      window.relearn.disableInlineCopyToClipboard=true;
      window.relearn.enableBlockCodeWrap=false;
      // legal
      window.relearn.getItem = (s,n) => {return s.getItem(n)};
      window.relearn.setItem = (s,n,v) => {return s.setItem(n,v)};
      window.relearn.removeItem = (s,n) => {return s.removeItem(n)};
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
      // variant stuff
      window.relearn.themevariants = [ 'auto', 'light-theme', 'dark-theme' ];
      window.relearn.customvariantname = "my-custom-variant";
      // [x] russfeld
      window.relearn.writeVariant=true;
      window.relearn.changeVariant = function(variant) {
        var oldVariant = document.documentElement.dataset.rThemeVariant;
        window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        document.documentElement.dataset.rThemeVariant = variant;
        if (oldVariant != variant) {
          document.dispatchEvent( new CustomEvent('themeVariantLoaded', { detail: { variant, oldVariant } }) );
          window.relearn.markVariant();
        }
      }
      window.relearn.markVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant");
        document.querySelectorAll(".R-variantswitcher select").forEach((select) => {select.value = variant;});
      }
      window.relearn.initVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant") ?? "";
        if( variant == window.relearn.customvariantname ){
        }else if( !variant || !window.relearn.themevariants.includes(variant) ){
          variant = window.relearn.themevariants[0];
          
          if (window.relearn.writeVariant) {
            window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
          }
        }
        document.documentElement.dataset.rThemeVariant = variant;
      }
      window.relearn.initVariant();
      window.relearn.markVariant();
    </script>
    <link href="/cis580/css/custom.css?1755628803" rel="stylesheet">
  </head>
  <body class="mobile-support html" data-url="/cis580/09-particle-systems/03-particle-system-class/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
<nav class="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#constants">Constants</a></li>
        <li><a href="#static-fields">Static Fields</a></li>
        <li><a href="#private-fields">Private Fields</a></li>
        <li><a href="#public-fields">Public Fields</a></li>
        <li><a href="#protected-fields">Protected Fields</a></li>
        <li><a href="#constructor">Constructor</a></li>
        <li><a href="#virtual-hook-methods">Virtual Hook Methods</a></li>
        <li><a href="#drawablegamecomponent-overrides">DrawableGameComponent Overrides</a></li>
        <li><a href="#methods-for-adding-particles-to-the-system">Methods for Adding Particles to the System</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
              </div>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class="a11y-only"><a itemprop="item" href="/cis580/index.html"><span itemprop="name">CIS 580: Foundations of Game Programming</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="/cis580/09-particle-systems/index.html"><span itemprop="name">Particle Systems</span></a><meta itemprop="position" content="2">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><span itemprop="name">The Particle System Class</span><meta itemprop="position" content="3"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-edit" data-content-empty="disable" data-width-s="area-more" data-width-m="show" data-width-l="show"><a class="topbar-control" href="https://github.com/ksu-cs-textbooks/cis580/edit/master/content/09-particle-systems/03-particle-system-class.md" rel="external" target="_blank" title="Edit (CTRL+ALT+w)"><i class="fa-fw fas fa-pen"></i></a>
            </div>
            <div class="topbar-button topbar-button-print" data-content-empty="disable" data-width-s="area-more" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/cis580/09-particle-systems/03-particle-system-class/index.print.html" title="Print whole chapter (CTRL+ALT+p)"><i class="fa-fw fas fa-print"></i></a>
            </div>
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/cis580/09-particle-systems/02-particle-class/index.html" title="The Particle (🡐)"><i class="fa-fw fas fa-chevron-left"></i></a>
            </div>
            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/cis580/09-particle-systems/04-example-particle-systems/index.html" title="Example Particle Systems (🡒)"><i class="fa-fw fas fa-chevron-right"></i></a>
            </div>
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
            <div class="topbar-button topbar-button-embed" data-content-empty="disable" data-width-s="area-more" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/cis580/09-particle-systems/03-particle-system-class/embed.html" title="Embeddable Version"><i class="fa-fw fas fa-expand-arrows-alt"></i></a>
            </div>
            <div class="topbar-button topbar-button-tele" data-content-empty="disable" data-width-s="area-more" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/cis580/09-particle-systems/03-particle-system-class/tele.html" title="Teleprompter View"><i class="fa-fw fas fa-tv"></i></a>
            </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable 09-particle-systems" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>

<h1 id="the-particle-system-class">The Particle System Class</h1>

<p>The next part of the particle system is the class representing the particle system itself.  Like any other sprite-based strategy, this will involve both an <code>Update()</code> and <code>Draw()</code> method that must be invoked every time through the game loop.  But ideally we&rsquo;d like our particle systems to be an almost hands-off system - once it&rsquo;s created, we can just let it do its thing without intervention.  This is where the idea of game components from our <a href="/cis580/09-particle-systems/03-particle-system-class/index.html">architecture discussion</a> can come into play - our particle system can inherit from the  <code>DrawableGameComponent</code> class, which means it can be added to to our <code>Game.Components</code> list and the <code>Game</code> will handle invoking those methods for us every frame:</p>
<div class="highlight" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// A class representing a generic particle system</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ParticleSystem</span> : DrawableGameComponent
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// TODO: Add fields, properties, and methods</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Now we want to add generic functionality for a particle system, and in doing so, we want to make sure the system is as efficient as possible - remember, we may be updating and rendering <em>thousands</em> of sprites for each active particle system.  We&rsquo;ll keep this in mind throughout the design process.  Let&rsquo;s start by defining some fields that determine the behavior of the particle system.  As we do this, we&rsquo;ll stretch our use of the C# programming language in ways you may have not done so previously.</p>
<h3 id="constants">Constants</h3>
<p>We&rsquo;ll start by defining a couple of constants, <code>AlphaBlendDrawOrder</code> and <code>AdditiveBlendDrawOrder</code>:</p>
<div class="highlight" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// The draw order for particles using Alpha Blending</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;remarks&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Particles drawn using additive blending should be drawn on top of </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// particles that use regular alpha blending</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/remarks&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> AlphaBlendDrawOrder = <span style="color:#ae81ff">100</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// The draw order for particles using Additive Blending</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;remarks&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Particles drawn using additive blending should be drawn on top of </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// particles that use regular alpha blending</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/remarks&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> AdditiveBlendDrawOrder = <span style="color:#ae81ff">200</span>;</span></span></code></pre></div>
<p>Remember that the <code>DrawOrder</code> property of a <code>DrawableGameComponent</code> determines the order in which they are drawn.  These constants represent values we can reference when setting that draw order, based on what kind of alpha blending we are using.</p>
<h3 id="static-fields">Static Fields</h3>
<p>To use our particle systems, we&rsquo;ll need both a <code>ContentManager</code> and <code>SpriteBatch</code> instance.  We could create one for each particle system, but that creates a lot of unnecessary objects.  Alternatively, we could share the ones created in our <code>Game</code> class, which would be the most efficient approach.  However, that does mean those need to be made public, and we need to pass the derived class into this one.  As a comfortable middle ground, we&rsquo;ll create protected static fields for these, so that all particle systems share a single set:</p>
<div class="highlight" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// A SpriteBatch to share amongst the various particle systems</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">static</span> SpriteBatch spriteBatch;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// A ContentManager to share amongst the various particle systems</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">static</span> ContentManager contentManager;</span></span></code></pre></div>
<h3 id="private-fields">Private Fields</h3>
<p>This class needs to hold our collection of particles, and in keeping with the <a href="https://gameprogrammingpatterns.com/data-locality.html" rel="external" target="_blank">data locality pattern</a>, we&rsquo;d like these to be stored sequentially.  An array is therefore a great fit.  Add it as a private field to the class:</p>
<div class="highlight" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// The collection of particles </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    Particle[] particles;</span></span></code></pre></div>
<p>We&rsquo;ll also use a <code>Queue</code> (from <code>System.Collections.Generic</code>) to hold references to unused particles.  This way we can avoid re-creating particles and creating a glut in memory that will result in the garbage collector running often.  We could store a reference directly to the particle location, or an index indicating its position in the array.  We&rsquo;ll opt for the former here, as it provides some benefits in usage:</p>
<div class="highlight" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// A Queue containing indices of unused particles in the Particles array</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    Queue&lt;Particle&gt; freeParticles;</span></span></code></pre></div>
<p>As we said in the discussion of the <code>Particle</code> class, in using the <a href="https://gameprogrammingpatterns.com/flyweight.html" rel="external" target="_blank">Flyweight Pattern</a> the actual texture will be held by our <code>ParticleSystem</code>, so let&rsquo;s add a private variable to hold that:</p>
<div class="highlight" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// The texture this particle system uses </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    Texture2D texture;</span></span></code></pre></div>
<p>We&rsquo;ll also keep track of an origin vector for when we draw the textures:</p>
<div class="highlight" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// The origin when we&#39;re drawing textures </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    Vector2 origin;</span></span></code></pre></div>
<h3 id="public-fields">Public Fields</h3>
<p>It can also be useful to know how many particles are currently available (free) in the system.  We can expose this value with a public property:</p>
<div class="highlight" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// The available particles in the system </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> FreeParticleCount =&gt; freeParticles.Count;</span></span></code></pre></div>
<h3 id="protected-fields">Protected Fields</h3>
<p>A slightly unique approach we&rsquo;ll adopt here is defining a number of <code>protected</code> fields that essentially define the behavior of the particle system.  These represent the information that is shared amongst all particles in the system.  We make them protected so that derived particle systems can adjust them to suit the needs of the effect we are trying to create.  For example the <code>blendState</code> determines how a texture is drawn, and the <code>textureFilename</code> helps define which texture to use:</p>
<div class="highlight" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;The BlendState to use with this particle system&lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> BlendState blendState = BlendState.AlphaBlend;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;The filename of the texture to use for the particles&lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">string</span> textureFilename;</span></span></code></pre></div>
<p>We&rsquo;ll also use a min/max pair to determine the number of particles to activate in the system each time we add particles:</p>
<div class="highlight" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;The minimum number of particles to add when AddParticles() is called&lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">int</span> minNumParticles;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;The maximum number of particles to add when AddParticles() is called&lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">int</span> maxNumParticles;</span></span></code></pre></div>
<p>Like the <code>Particle</code> class&rsquo; fields, these too could be tweaked to meet the needs of your game.</p>
<h3 id="constructor">Constructor</h3>
<p>As the <code>DrawableGameComponent</code> has a constructor requiring a <code>Game</code> instance, we must provide our own constructor that passes that along by invoking <code>base()</code> (which runs the constructor of the base object).  We&rsquo;ll also want to initialize our <code>particles</code> array and <code>freeParticles</code> queue, which means we need to know the maximum number of particles we&rsquo;ll allow in this particle system.  Therefore, we&rsquo;ll add that as a second parameter.</p>
<div class="highlight" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Constructs a new instance of a particle system</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;param name=&#34;game&#34;&gt;&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> ParticleSystem(Game game, <span style="color:#66d9ef">int</span> maxParticles) : <span style="color:#66d9ef">base</span>(game) 
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Create our particles</span>
</span></span><span style="display:flex;"><span>        particles = <span style="color:#66d9ef">new</span> Particle[maxParticles];
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i = <span style="color:#ae81ff">0</span>; i &lt; particles.Length; i++)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            particles[i] = <span style="color:#66d9ef">new</span> Particle();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Add all free particles to the queue</span>
</span></span><span style="display:flex;"><span>        freeParticles = <span style="color:#66d9ef">new</span> Queue&lt;Particle&gt;(particles);
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Run the InitializeConstants hook</span>
</span></span><span style="display:flex;"><span>        InitializeConstants();
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div>
<p>Since none of the particles are in use, we&rsquo;ll also initialize our Queue with <em>all</em> the newly created particles.  This has the helpful side effect of allocating enough memory to hold a reference to each particle in our array, ensuring we never need to re-allocate.</p>
<p>Finally, we invoke <code>InitializeConstants()</code>, a protected method that is intended to be used as a <em>hook</em> - a method that can be overridden to inject your own functionality into the class.  Let&rsquo;s look at this, and the other hook methods next</p>
<h3 id="virtual-hook-methods">Virtual Hook Methods</h3>
<p>Now that we have the structure of the class put together, let&rsquo;s start thinking about the functionality.  We&rsquo;ll write a couple of <code>virtual</code> hook methods to define the default behavior we expect from our particles - most notably setting those protected constant values, <em>initializing</em> new active particles to the particle system, and then <em>updating</em> those particles each frame.  We&rsquo;ll make these methods virtual so we can override them in derived classes, but also provide a base implementation when one makes sense.  Let&rsquo;s start with <code>InitializeConstants()</code> we invoked above:</p>
<div class="highlight" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Used to do the initial configuration of the particle engine.  The </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// protected constants `textureFilename`, `minNumParticles`, and `maxNumParticles`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// should be set in the override.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> InitializeConstants() { }</span></span></code></pre></div>
<p>If the <code>textureFilename</code> is not set here, we&rsquo;ll encounter a runtime error, so this <em>must</em> be overridden in the derived classes. As a possible way to emphasize this, we could instead declare this method, and the <code>ParticleSystem</code> class as <code>abstract</code>.</p>
<p>In contrast, the <code>InitializeParticle()</code> hook method will provide some logic that could potentially be used, but will also probably be overridden in most cases:</p>
<div class="highlight" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// InitializeParticle randomizes some properties for a particle, then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// calls initialize on it. It can be overridden by subclasses if they </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// want to modify the way particles are created.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;param name=&#34;p&#34;&gt;the particle to initialize&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;param name=&#34;where&#34;&gt;the position on the screen that the particle should be</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> InitializeParticle(Particle p, Vector2 <span style="color:#66d9ef">where</span>)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Initialize the particle with default values</span>
</span></span><span style="display:flex;"><span>        p.Initialize(<span style="color:#66d9ef">where</span>);
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div>
<p>Similarly, we will supply a default implementation for <em>updating</em> a particle.  Our default approach is based on Newtonian physics:</p>
<div class="highlight" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Updates the individual particles.  Can be overridden in derived classes</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;param name=&#34;particle&#34;&gt;The particle to update&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;param name=&#34;dt&#34;&gt;The elapsed time&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">void</span> UpdateParticle(Particle particle, <span style="color:#66d9ef">float</span> dt)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Update particle&#39;s linear motion values</span>
</span></span><span style="display:flex;"><span>        particle.Velocity += particle.Acceleration * dt;
</span></span><span style="display:flex;"><span>        particle.Position += particle.Velocity * dt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Update the particle&#39;s angular motion values</span>
</span></span><span style="display:flex;"><span>        particle.AngularVelocity += particle.AngularAcceleration * dt;
</span></span><span style="display:flex;"><span>        particle.Rotation += particle.AngularVelocity * dt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Update the time the particle has been alive </span>
</span></span><span style="display:flex;"><span>        particle.TimeSinceStart += dt;
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div>
<p>This implementation works for a wide variety of particle systems, but it can be overridden by a derived particle system if something different is needed.</p>
<h3 id="drawablegamecomponent-overrides">DrawableGameComponent Overrides</h3>
<p>Now we can tackle the methods from <code>DrawableGameComponent</code>, which we&rsquo;ll need to replace with our own custom overrides.  First, we&rsquo;ll load the texture in our <code>LoadContent</code>:</p>
<div class="highlight" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Override the base class LoadContent to load the texture. once it&#39;s</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// loaded, calculate the origin.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;throws&gt;A InvalidOperationException if the texture filename is not provided&lt;/throws&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">void</span> LoadContent()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// create the shared static ContentManager and SpriteBatch,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// if this hasn&#39;t already been done by another particle engine</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (contentManager == <span style="color:#66d9ef">null</span>) contentManager = <span style="color:#66d9ef">new</span> ContentManager(Game.Services, <span style="color:#e6db74">&#34;Content&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (spriteBatch == <span style="color:#66d9ef">null</span>) spriteBatch = <span style="color:#66d9ef">new</span> SpriteBatch(Game.GraphicsDevice);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// make sure sub classes properly set textureFilename.</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">string</span>.IsNullOrEmpty(textureFilename))
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">string</span> message = <span style="color:#e6db74">&#34;textureFilename wasn&#39;t set properly, so the &#34;</span> +
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;particle system doesn&#39;t know what texture to load. Make &#34;</span> +
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;sure your particle system&#39;s InitializeConstants function &#34;</span> +
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;properly sets textureFilename.&#34;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> InvalidOperationException(message);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// load the texture....</span>
</span></span><span style="display:flex;"><span>        texture = contentManager.Load&lt;Texture2D&gt;(textureFilename);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// ... and calculate the center. this&#39;ll be used in the draw call, we</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// always want to rotate and scale around this point.</span>
</span></span><span style="display:flex;"><span>        origin.X = texture.Width / <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>        origin.Y = texture.Height / <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">base</span>.LoadContent();
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div>
<p>In addition to loading the texture, we make sure that our shared <code>ContentManager</code> and <code>SpriteBatch</code> are created, and calculate the <code>Origin</code> for the texture.</p>
<p>Our <code>Update()</code> method iterates over the particles and updates each one, invoking our <code>UpdateParticle()</code> method:</p>
<div class="highlight" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Overriden from DrawableGameComponent, Update will update all of the active</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// particles.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">void</span> Update(GameTime gameTime)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// calculate dt, the change in the since the last frame. the particle</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// updates will use this value.</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">float</span> dt = (<span style="color:#66d9ef">float</span>)gameTime.ElapsedGameTime.TotalSeconds;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// go through all of the particles...</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">foreach</span> (Particle p <span style="color:#66d9ef">in</span> particles)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (p.Active)
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// ... and if they&#39;re active, update them.</span>
</span></span><span style="display:flex;"><span>                UpdateParticle(p, dt);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// if that update finishes them, put them onto the free particles</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// queue.</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (!p.Active)
</span></span><span style="display:flex;"><span>                {
</span></span><span style="display:flex;"><span>                    freeParticles.Enqueue(p);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">base</span>.Update(gameTime);
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div>
<p>Notice that we only update the <em>active</em> particles.  And if a particle is no longer active after we update it, we add it to the <code>freeParticles</code> queue to be reused.</p>
<p>Similarly, our <code>Draw()</code> method draws only the active particles:</p>
<div class="highlight" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Overriden from DrawableGameComponent, Draw will use the static </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// SpriteBatch to render all of the active particles.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">void</span> Draw(GameTime gameTime)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// tell sprite batch to begin, using the BlendState specified in</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// initializeConstants</span>
</span></span><span style="display:flex;"><span>        spriteBatch.Begin(blendState: blendState);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">foreach</span> (Particle p <span style="color:#66d9ef">in</span> particles)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// skip inactive particles</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (!p.Active)
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">continue</span>;
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            spriteBatch.Draw(texture, p.Position, <span style="color:#66d9ef">null</span>, p.Color,
</span></span><span style="display:flex;"><span>                p.Rotation, origin, <span style="color:#ae81ff">1</span>, SpriteEffects.None, <span style="color:#ae81ff">0.0f</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        spriteBatch.End();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">base</span>.Draw(gameTime);
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div>
<p>Note that we provide a <code>SpriteBlendState</code> to the <code>SpriteBatch.Begin()</code> call, as different blend states can replicate different effects.  We&rsquo;ll see this in play soon.</p>
<h3 id="methods-for-adding-particles-to-the-system">Methods for Adding Particles to the System</h3>
<p>Finally, we need some methods to add active particles into our system (otherwise, nothing will ever be drawn)!  We&rsquo;ll create two generic protected methods for doing this, which can be utilized by the derived particle system classes.  We&rsquo;ll start with one that adds particles at a specific position (defined by a <code>Vector2</code>):</p>
<div class="highlight" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// AddParticles&#39;s job is to add an effect somewhere on the screen. If there </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// aren&#39;t enough particles in the freeParticles queue, it will use as many as </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// it can. This means that if there not enough particles available, calling</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// AddParticles will have no effect.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;param name=&#34;where&#34;&gt;where the particle effect should be created&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">void</span> AddParticles(Vector2 <span style="color:#66d9ef">where</span>)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// the number of particles we want for this effect is a random number</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// somewhere between the two constants specified by the subclasses.</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> numParticles =
</span></span><span style="display:flex;"><span>            RandomHelper.Next(minNumParticles, maxNumParticles);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// create that many particles, if you can.</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i = <span style="color:#ae81ff">0</span>; i &lt; numParticles &amp;&amp; freeParticles.Count &gt; <span style="color:#ae81ff">0</span>; i++)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// grab a particle from the freeParticles queue, and Initialize it.</span>
</span></span><span style="display:flex;"><span>            Particle p = freeParticles.Dequeue();
</span></span><span style="display:flex;"><span>            InitializeParticle(p, <span style="color:#66d9ef">where</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div>
<p>This approach is especially useful for effects like explosions, which start with a bunch of particles, but don&rsquo;t create more.</p>
<p>We may instead want to supply a region of screen space (say, a rectangle) to fill with particles:</p>
<div class="highlight" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// AddParticles&#39;s job is to add an effect somewhere on the screen. If there </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// aren&#39;t enough particles in the freeParticles queue, it will use as many as </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// it can. This means that if there not enough particles available, calling</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// AddParticles will have no effect.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;param name=&#34;where&#34;&gt;where the particle effect should be created&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">void</span> AddParticles(Rectangle <span style="color:#66d9ef">where</span>)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// the number of particles we want for this effect is a random number</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// somewhere between the two constants specified by the subclasses.</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> numParticles =
</span></span><span style="display:flex;"><span>            RandomHelper.Next(minNumParticles, maxNumParticles);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// create that many particles, if you can.</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i = <span style="color:#ae81ff">0</span>; i &lt; numParticles &amp;&amp; freeParticles.Count &gt; <span style="color:#ae81ff">0</span>; i++)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// grab a particle from the freeParticles queue, and Initialize it.</span>
</span></span><span style="display:flex;"><span>            Particle p = freeParticles.Dequeue();
</span></span><span style="display:flex;"><span>            InitializeParticle(p, RandomHelper.RandomPosition(<span style="color:#66d9ef">where</span>));
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div>
<p>This works well for something like rain and snow - we can add it just off-screen (say above the top of the screen) and let it flow over the screen based on its direction and speed.</p>

  <footer class="footline">
  </footer>
</article>
        </div>
      </main>
<div class="git-footer">
  <p class="theme-version-footer">8.0.0</p>
<p>Last modified by:
              <i class='fa-fw fas fa-user'></i> Nathan Bean
              <i class='fas fa-calendar'></i> <a href="https://github.com/ksu-cs-textbooks/cis580/commit/d99e64bf8b59ec9d0a652c21e2c84da98a12b81e">Mar 31, 2021</a>
</p>

</div>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">

<a id="logo" href="/cis580/">
  CIS 580: Game Programming
</a>

        </div>
        <search><form action="/cis580/search/index.html" method="get">
          <div class="searchbox default-animation">
            <button class="search-detail" type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
            <label class="a11y-only" for="R-search-by">Search</label>
            <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
            <button class="search-clear" type="button" data-search-clear="" title="Clear search"><i class="fas fa-times" title="Clear search"></i></button>
          </div>
        </form></search>
      </div>
      <div id="R-homelinks" class="default-animation">
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-homelinks">
          <ul class="space collapsible-menu">
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-headercontrols">
          <ul class="">
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div class="R-sidebarmenu R-shortcutmenu-main">
          <ul class="enlarge morespace collapsible-menu">
            <li class="" data-nav-id="/cis580/00-forward/index.html"><input type="checkbox" id="R-section-d56da7af470aa6bd8c7f20f71c14743b" aria-controls="R-subsections-d56da7af470aa6bd8c7f20f71c14743b"><label for="R-section-d56da7af470aa6bd8c7f20f71c14743b"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Course Information</span></label><a class="padding" href="/cis580/00-forward/index.html">0. Course Information</a><ul id="R-subsections-d56da7af470aa6bd8c7f20f71c14743b" class="collapsible-menu">
            <li class="" data-nav-id="/cis580/00-forward/01-introduction/index.html"><a class="padding" href="/cis580/00-forward/01-introduction/index.html">1. Course Introduction</a></li>
            <li class="" data-nav-id="/cis580/00-forward/02-course-structure/index.html"><a class="padding" href="/cis580/00-forward/02-course-structure/index.html">2. Course Structure</a></li>
            <li class="" data-nav-id="/cis580/00-forward/03-workshop-etiquette/index.html"><a class="padding" href="/cis580/00-forward/03-workshop-etiquette/index.html">3. Workshop Etiquette</a></li>
            <li class="" data-nav-id="/cis580/00-forward/04-where-to-find-help/index.html"><a class="padding" href="/cis580/00-forward/04-where-to-find-help/index.html">4. Where to Find Help</a></li>
            <li class="" data-nav-id="/cis580/00-forward/05-what-you-will-learn/index.html"><a class="padding" href="/cis580/00-forward/05-what-you-will-learn/index.html">5. What you Will Learn</a></li>
            <li class="" data-nav-id="/cis580/00-forward/06-textbooks/index.html"><a class="padding" href="/cis580/00-forward/06-textbooks/index.html">6. Course Textbooks</a></li>
            <li class="" data-nav-id="/cis580/00-forward/07-software/index.html"><a class="padding" href="/cis580/00-forward/07-software/index.html">7. Course Software</a></li>
            <li class="" data-nav-id="/cis580/00-forward/08-assets/index.html"><a class="padding" href="/cis580/00-forward/08-assets/index.html">8. Assets</a></li>
            <li class="" data-nav-id="/cis580/00-forward/09-syllabus/index.html"><a class="padding" href="/cis580/00-forward/09-syllabus/index.html">9. Syllabus</a></li></ul></li>
            <li class="" data-nav-id="/cis580/01-intro-to-monogame/index.html"><input type="checkbox" id="R-section-c095ff2e81bd5181a01d881fac60ab8d" aria-controls="R-subsections-c095ff2e81bd5181a01d881fac60ab8d"><label for="R-section-c095ff2e81bd5181a01d881fac60ab8d"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Introduction to MonoGame</span></label><a class="padding" href="/cis580/01-intro-to-monogame/index.html">1. Introduction to MonoGame</a><ul id="R-subsections-c095ff2e81bd5181a01d881fac60ab8d" class="collapsible-menu">
            <li class="" data-nav-id="/cis580/01-intro-to-monogame/01-introduction/index.html"><a class="padding" href="/cis580/01-intro-to-monogame/01-introduction/index.html">1. Introduction</a></li>
            <li class="" data-nav-id="/cis580/01-intro-to-monogame/02-the-game-class/index.html"><a class="padding" href="/cis580/01-intro-to-monogame/02-the-game-class/index.html">2. The Game Class</a></li>
            <li class="" data-nav-id="/cis580/01-intro-to-monogame/03-the-game-window/index.html"><a class="padding" href="/cis580/01-intro-to-monogame/03-the-game-window/index.html">3. The Game Window</a></li>
            <li class="" data-nav-id="/cis580/01-intro-to-monogame/04-game-initialization/index.html"><a class="padding" href="/cis580/01-intro-to-monogame/04-game-initialization/index.html">4. Game Initialization</a></li>
            <li class="" data-nav-id="/cis580/01-intro-to-monogame/05-the-update-method/index.html"><a class="padding" href="/cis580/01-intro-to-monogame/05-the-update-method/index.html">5. The Update Method</a></li>
            <li class="" data-nav-id="/cis580/01-intro-to-monogame/06-the-draw-method/index.html"><a class="padding" href="/cis580/01-intro-to-monogame/06-the-draw-method/index.html">6. The Draw Method</a></li>
            <li class="" data-nav-id="/cis580/01-intro-to-monogame/07-summary/index.html"><a class="padding" href="/cis580/01-intro-to-monogame/07-summary/index.html">7. Summary</a></li></ul></li>
            <li class="" data-nav-id="/cis580/02-player-input/index.html"><input type="checkbox" id="R-section-f385a2559250473666122b8d6af222ce" aria-controls="R-subsections-f385a2559250473666122b8d6af222ce"><label for="R-section-f385a2559250473666122b8d6af222ce"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Player Input</span></label><a class="padding" href="/cis580/02-player-input/index.html">2. Player Input</a><ul id="R-subsections-f385a2559250473666122b8d6af222ce" class="collapsible-menu">
            <li class="" data-nav-id="/cis580/02-player-input/01-introduction/index.html"><a class="padding" href="/cis580/02-player-input/01-introduction/index.html">1. Introduction</a></li>
            <li class="" data-nav-id="/cis580/02-player-input/02-input-polling/index.html"><a class="padding" href="/cis580/02-player-input/02-input-polling/index.html">2. Input Polling</a></li>
            <li class="" data-nav-id="/cis580/02-player-input/03-keyboard-input/index.html"><a class="padding" href="/cis580/02-player-input/03-keyboard-input/index.html">3. Keyboard Input</a></li>
            <li class="" data-nav-id="/cis580/02-player-input/04-mouse-input/index.html"><a class="padding" href="/cis580/02-player-input/04-mouse-input/index.html">4. Mouse Input</a></li>
            <li class="" data-nav-id="/cis580/02-player-input/05-gamepad-input/index.html"><a class="padding" href="/cis580/02-player-input/05-gamepad-input/index.html">5. Gamepad Input</a></li>
            <li class="" data-nav-id="/cis580/02-player-input/06-input-manager/index.html"><a class="padding" href="/cis580/02-player-input/06-input-manager/index.html">6. Input Manager</a></li>
            <li class="" data-nav-id="/cis580/02-player-input/07-input-state/index.html"><a class="padding" href="/cis580/02-player-input/07-input-state/index.html">7. Input State</a></li>
            <li class="" data-nav-id="/cis580/02-player-input/08-summary/index.html"><a class="padding" href="/cis580/02-player-input/08-summary/index.html">8. Summary</a></li></ul></li>
            <li class="" data-nav-id="/cis580/03-sprites/index.html"><input type="checkbox" id="R-section-3a7f527525406a6e40450e2eba1a6abb" aria-controls="R-subsections-3a7f527525406a6e40450e2eba1a6abb"><label for="R-section-3a7f527525406a6e40450e2eba1a6abb"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Sprites</span></label><a class="padding" href="/cis580/03-sprites/index.html">3. Sprites</a><ul id="R-subsections-3a7f527525406a6e40450e2eba1a6abb" class="collapsible-menu">
            <li class="" data-nav-id="/cis580/03-sprites/01-introduction/index.html"><a class="padding" href="/cis580/03-sprites/01-introduction/index.html">1. Introduction</a></li>
            <li class="" data-nav-id="/cis580/03-sprites/02-drawing-sprites/index.html"><a class="padding" href="/cis580/03-sprites/02-drawing-sprites/index.html">2. Drawing Sprites</a></li>
            <li class="" data-nav-id="/cis580/03-sprites/03-texture-atlases/index.html"><a class="padding" href="/cis580/03-sprites/03-texture-atlases/index.html">3. Texture Atlases</a></li>
            <li class="" data-nav-id="/cis580/03-sprites/04-animated-sprites/index.html"><a class="padding" href="/cis580/03-sprites/04-animated-sprites/index.html">4. Animated Sprites</a></li>
            <li class="" data-nav-id="/cis580/03-sprites/05-drawing-text/index.html"><a class="padding" href="/cis580/03-sprites/05-drawing-text/index.html">4. Sprite Text</a></li>
            <li class="" data-nav-id="/cis580/03-sprites/06-sorting-sprites/index.html"><a class="padding" href="/cis580/03-sprites/06-sorting-sprites/index.html">6. Sorting Sprites</a></li>
            <li class="" data-nav-id="/cis580/03-sprites/07-summary/index.html"><a class="padding" href="/cis580/03-sprites/07-summary/index.html">7. Summary</a></li></ul></li>
            <li class="" data-nav-id="/cis580/04-collisions/index.html"><input type="checkbox" id="R-section-1a1d1ca934de92e8653e2566fc7c678c" aria-controls="R-subsections-1a1d1ca934de92e8653e2566fc7c678c"><label for="R-section-1a1d1ca934de92e8653e2566fc7c678c"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Collisions</span></label><a class="padding" href="/cis580/04-collisions/index.html">4. Collisions</a><ul id="R-subsections-1a1d1ca934de92e8653e2566fc7c678c" class="collapsible-menu">
            <li class="" data-nav-id="/cis580/04-collisions/01-introduction/index.html"><a class="padding" href="/cis580/04-collisions/01-introduction/index.html">1. Introduction</a></li>
            <li class="" data-nav-id="/cis580/04-collisions/02-collision-shapes/index.html"><a class="padding" href="/cis580/04-collisions/02-collision-shapes/index.html">2. Collision Shapes</a></li>
            <li class="" data-nav-id="/cis580/04-collisions/03-collision-helper/index.html"><a class="padding" href="/cis580/04-collisions/03-collision-helper/index.html">3. Collision Helper</a></li>
            <li class="" data-nav-id="/cis580/04-collisions/04-separating-axis-theorem/index.html"><a class="padding" href="/cis580/04-collisions/04-separating-axis-theorem/index.html">4. Separating Axis Theorem</a></li>
            <li class="" data-nav-id="/cis580/04-collisions/05-per-pixel/index.html"><a class="padding" href="/cis580/04-collisions/05-per-pixel/index.html">5. Per-Pixel Collision Detection</a></li>
            <li class="" data-nav-id="/cis580/04-collisions/06-multiphase/index.html"><a class="padding" href="/cis580/04-collisions/06-multiphase/index.html">6. Multiphase Collision Detection</a></li>
            <li class="" data-nav-id="/cis580/04-collisions/07-summary/index.html"><a class="padding" href="/cis580/04-collisions/07-summary/index.html">7. Summary</a></li></ul></li>
            <li class="" data-nav-id="/cis580/05-audio/index.html"><input type="checkbox" id="R-section-f2944d5ab2da96ebec7cd4361d9858b5" aria-controls="R-subsections-f2944d5ab2da96ebec7cd4361d9858b5"><label for="R-section-f2944d5ab2da96ebec7cd4361d9858b5"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Audio</span></label><a class="padding" href="/cis580/05-audio/index.html">5. Audio</a><ul id="R-subsections-f2944d5ab2da96ebec7cd4361d9858b5" class="collapsible-menu">
            <li class="" data-nav-id="/cis580/05-audio/01-introduction/index.html"><a class="padding" href="/cis580/05-audio/01-introduction/index.html">1. Introduction</a></li>
            <li class="" data-nav-id="/cis580/05-audio/02-sound-effects/index.html"><a class="padding" href="/cis580/05-audio/02-sound-effects/index.html">2. Sound Effects</a></li>
            <li class="" data-nav-id="/cis580/05-audio/03-positional-sounds/index.html"><a class="padding" href="/cis580/05-audio/03-positional-sounds/index.html">3. Positional Sounds</a></li>
            <li class="" data-nav-id="/cis580/05-audio/04-music/index.html"><a class="padding" href="/cis580/05-audio/04-music/index.html">4. Music</a></li></ul></li>
            <li class="" data-nav-id="/cis580/06-physics/index.html"><input type="checkbox" id="R-section-b7123bd145f50da2b2c896c18a26eec8" aria-controls="R-subsections-b7123bd145f50da2b2c896c18a26eec8"><label for="R-section-b7123bd145f50da2b2c896c18a26eec8"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Physics</span></label><a class="padding" href="/cis580/06-physics/index.html">6. Physics</a><ul id="R-subsections-b7123bd145f50da2b2c896c18a26eec8" class="collapsible-menu">
            <li class="" data-nav-id="/cis580/06-physics/01-introduction/index.html"><a class="padding" href="/cis580/06-physics/01-introduction/index.html">1. Introduction</a></li>
            <li class="" data-nav-id="/cis580/06-physics/02-linear-dynamics/index.html"><a class="padding" href="/cis580/06-physics/02-linear-dynamics/index.html">2. Linear Dynamics</a></li>
            <li class="" data-nav-id="/cis580/06-physics/03-angular-dynamics/index.html"><a class="padding" href="/cis580/06-physics/03-angular-dynamics/index.html">3. Angular Dynamics</a></li>
            <li class="" data-nav-id="/cis580/06-physics/04-elastic-collisions/index.html"><a class="padding" href="/cis580/06-physics/04-elastic-collisions/index.html">4. Elastic Collisions</a></li>
            <li class="" data-nav-id="/cis580/06-physics/05-physics-engines/index.html"><a class="padding" href="/cis580/06-physics/05-physics-engines/index.html">6. Physics Engines</a></li></ul></li>
            <li class="" data-nav-id="/cis580/07-game-architecture/index.html"><input type="checkbox" id="R-section-a8a72b23259d31d135fbca57788fa750" aria-controls="R-subsections-a8a72b23259d31d135fbca57788fa750"><label for="R-section-a8a72b23259d31d135fbca57788fa750"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Game Architecture</span></label><a class="padding" href="/cis580/07-game-architecture/index.html">7. Game Architecture</a><ul id="R-subsections-a8a72b23259d31d135fbca57788fa750" class="collapsible-menu">
            <li class="" data-nav-id="/cis580/07-game-architecture/01-introduction/index.html"><a class="padding" href="/cis580/07-game-architecture/01-introduction/index.html">1. Introduction</a></li>
            <li class="" data-nav-id="/cis580/07-game-architecture/02-game-services/index.html"><a class="padding" href="/cis580/07-game-architecture/02-game-services/index.html">2. Game Services</a></li>
            <li class="" data-nav-id="/cis580/07-game-architecture/03-game-components/index.html"><a class="padding" href="/cis580/07-game-architecture/03-game-components/index.html">3. Game Components</a></li>
            <li class="" data-nav-id="/cis580/07-game-architecture/04-game-screens/index.html"><a class="padding" href="/cis580/07-game-architecture/04-game-screens/index.html">4. Game Screens</a></li>
            <li class="" data-nav-id="/cis580/07-game-architecture/05-summary/index.html"><a class="padding" href="/cis580/07-game-architecture/05-summary/index.html">5. Summary</a></li></ul></li>
            <li class="" data-nav-id="/cis580/08-spritebatch-transforms/index.html"><input type="checkbox" id="R-section-c9320f717dad2dfd3e2581f6fce44a3e" aria-controls="R-subsections-c9320f717dad2dfd3e2581f6fce44a3e"><label for="R-section-c9320f717dad2dfd3e2581f6fce44a3e"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu SpriteBatch Transforms</span></label><a class="padding" href="/cis580/08-spritebatch-transforms/index.html">8. SpriteBatch Transforms</a><ul id="R-subsections-c9320f717dad2dfd3e2581f6fce44a3e" class="collapsible-menu">
            <li class="" data-nav-id="/cis580/08-spritebatch-transforms/01-introduction/index.html"><a class="padding" href="/cis580/08-spritebatch-transforms/01-introduction/index.html">1. Introduction</a></li>
            <li class="" data-nav-id="/cis580/08-spritebatch-transforms/02-transforms/index.html"><a class="padding" href="/cis580/08-spritebatch-transforms/02-transforms/index.html">2. Transforms</a></li>
            <li class="" data-nav-id="/cis580/08-spritebatch-transforms/03-screen-scrolling/index.html"><a class="padding" href="/cis580/08-spritebatch-transforms/03-screen-scrolling/index.html">3. Screen Scrolling</a></li>
            <li class="" data-nav-id="/cis580/08-spritebatch-transforms/04-parallax-scrolling/index.html"><a class="padding" href="/cis580/08-spritebatch-transforms/04-parallax-scrolling/index.html">4. Parallax Scrolling</a></li>
            <li class="" data-nav-id="/cis580/08-spritebatch-transforms/06-screen-scaling/index.html"><a class="padding" href="/cis580/08-spritebatch-transforms/06-screen-scaling/index.html">5. Scaling to the Screen</a></li>
            <li class="" data-nav-id="/cis580/08-spritebatch-transforms/05-special-effects/index.html"><a class="padding" href="/cis580/08-spritebatch-transforms/05-special-effects/index.html">5. Special Effects</a></li>
            <li class="" data-nav-id="/cis580/08-spritebatch-transforms/07-summary/index.html"><a class="padding" href="/cis580/08-spritebatch-transforms/07-summary/index.html">7. Summary</a></li></ul></li>
            <li class="parent " data-nav-id="/cis580/09-particle-systems/index.html"><input type="checkbox" id="R-section-0eef764db11e5ba12bc3c22cad972827" aria-controls="R-subsections-0eef764db11e5ba12bc3c22cad972827" checked><label for="R-section-0eef764db11e5ba12bc3c22cad972827"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Particle Systems</span></label><a class="padding" href="/cis580/09-particle-systems/index.html">9. Particle Systems</a><ul id="R-subsections-0eef764db11e5ba12bc3c22cad972827" class="collapsible-menu">
            <li class="" data-nav-id="/cis580/09-particle-systems/01-introduction/index.html"><a class="padding" href="/cis580/09-particle-systems/01-introduction/index.html">1. Introduction</a></li>
            <li class="" data-nav-id="/cis580/09-particle-systems/02-particle-class/index.html"><a class="padding" href="/cis580/09-particle-systems/02-particle-class/index.html">2. The Particle</a></li>
            <li class="active " data-nav-id="/cis580/09-particle-systems/03-particle-system-class/index.html"><a class="padding" href="/cis580/09-particle-systems/03-particle-system-class/index.html">3. The Particle System Class</a></li>
            <li class="" data-nav-id="/cis580/09-particle-systems/04-example-particle-systems/index.html"><a class="padding" href="/cis580/09-particle-systems/04-example-particle-systems/index.html">4. Example Particle Systems</a></li>
            <li class="" data-nav-id="/cis580/09-particle-systems/05-using-particle-systems/index.html"><a class="padding" href="/cis580/09-particle-systems/05-using-particle-systems/index.html">5. Using Particle Systems</a></li>
            <li class="" data-nav-id="/cis580/09-particle-systems/06-summary/index.html"><a class="padding" href="/cis580/09-particle-systems/06-summary/index.html">6. Refactoring as a Game Component</a></li></ul></li>
            <li class="" data-nav-id="/cis580/10-tile-maps/index.html"><input type="checkbox" id="R-section-a8c710bf17e846b058cbb7a1b3d05f6d" aria-controls="R-subsections-a8c710bf17e846b058cbb7a1b3d05f6d"><label for="R-section-a8c710bf17e846b058cbb7a1b3d05f6d"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Tile Maps</span></label><a class="padding" href="/cis580/10-tile-maps/index.html">10. Tile Maps</a><ul id="R-subsections-a8c710bf17e846b058cbb7a1b3d05f6d" class="collapsible-menu">
            <li class="" data-nav-id="/cis580/10-tile-maps/01-introduction/index.html"><a class="padding" href="/cis580/10-tile-maps/01-introduction/index.html">1. Introduction</a></li>
            <li class="" data-nav-id="/cis580/10-tile-maps/02-tilemap-concepts/index.html"><a class="padding" href="/cis580/10-tile-maps/02-tilemap-concepts/index.html">2. Tilemap Concepts</a></li>
            <li class="" data-nav-id="/cis580/10-tile-maps/03-2d-and-1d-arrays/index.html"><a class="padding" href="/cis580/10-tile-maps/03-2d-and-1d-arrays/index.html">3. 2D and 1D Arrays</a></li>
            <li class="" data-nav-id="/cis580/10-tile-maps/04-a-basic-tilemap/index.html"><a class="padding" href="/cis580/10-tile-maps/04-a-basic-tilemap/index.html">4. A Basic Tile Engine</a></li>
            <li class="" data-nav-id="/cis580/10-tile-maps/05-tiled-editor/index.html"><a class="padding" href="/cis580/10-tile-maps/05-tiled-editor/index.html">5. Tiled Editor</a></li>
            <li class="" data-nav-id="/cis580/10-tile-maps/06-summary/index.html"><a class="padding" href="/cis580/10-tile-maps/06-summary/index.html">6. Summary</a></li></ul></li>
            <li class="" data-nav-id="/cis580/11-content-pipeline/index.html"><input type="checkbox" id="R-section-e5571b73e070a9e24b412a9287c6dac7" aria-controls="R-subsections-e5571b73e070a9e24b412a9287c6dac7"><label for="R-section-e5571b73e070a9e24b412a9287c6dac7"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Content Pipeline</span></label><a class="padding" href="/cis580/11-content-pipeline/index.html">11. Content Pipeline</a><ul id="R-subsections-e5571b73e070a9e24b412a9287c6dac7" class="collapsible-menu">
            <li class="" data-nav-id="/cis580/11-content-pipeline/01-introduction/index.html"><a class="padding" href="/cis580/11-content-pipeline/01-introduction/index.html">1. Introduction</a></li>
            <li class="" data-nav-id="/cis580/11-content-pipeline/02-the-content-pipeline/index.html"><a class="padding" href="/cis580/11-content-pipeline/02-the-content-pipeline/index.html">2. The Content Pipeline</a></li>
            <li class="" data-nav-id="/cis580/11-content-pipeline/03-extending-the-pipeline/index.html"><a class="padding" href="/cis580/11-content-pipeline/03-extending-the-pipeline/index.html">3. Extending the Pipeline</a></li>
            <li class="" data-nav-id="/cis580/11-content-pipeline/04-custom-importer/index.html"><a class="padding" href="/cis580/11-content-pipeline/04-custom-importer/index.html">4. Custom Importer</a></li>
            <li class="" data-nav-id="/cis580/11-content-pipeline/05-custom-processor/index.html"><a class="padding" href="/cis580/11-content-pipeline/05-custom-processor/index.html">5. Custom Processor</a></li>
            <li class="" data-nav-id="/cis580/11-content-pipeline/06-using-in-a-game/index.html"><a class="padding" href="/cis580/11-content-pipeline/06-using-in-a-game/index.html">6. Using in a Game</a></li>
            <li class="" data-nav-id="/cis580/11-content-pipeline/07-the-context/index.html"><a class="padding" href="/cis580/11-content-pipeline/07-the-context/index.html">7. The Context Object</a></li>
            <li class="" data-nav-id="/cis580/11-content-pipeline/08-summary/index.html"><a class="padding" href="/cis580/11-content-pipeline/08-summary/index.html">8. Summary</a></li></ul></li>
            <li class="" data-nav-id="/cis580/13-basic-3d-rendering/index.html"><input type="checkbox" id="R-section-c1410edcbeed2b2a6c66a28b10dd1f69" aria-controls="R-subsections-c1410edcbeed2b2a6c66a28b10dd1f69"><label for="R-section-c1410edcbeed2b2a6c66a28b10dd1f69"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Basic 3D Rendering</span></label><a class="padding" href="/cis580/13-basic-3d-rendering/index.html">13. Basic 3D Rendering</a><ul id="R-subsections-c1410edcbeed2b2a6c66a28b10dd1f69" class="collapsible-menu">
            <li class="" data-nav-id="/cis580/13-basic-3d-rendering/01-introduction/index.html"><a class="padding" href="/cis580/13-basic-3d-rendering/01-introduction/index.html">1. Introduction</a></li>
            <li class="" data-nav-id="/cis580/13-basic-3d-rendering/02-it-starts-with-triangles/index.html"><a class="padding" href="/cis580/13-basic-3d-rendering/02-it-starts-with-triangles/index.html">2. It Starts with Triangles</a></li>
            <li class="" data-nav-id="/cis580/13-basic-3d-rendering/03-rendering-a-textured-quad/index.html"><a class="padding" href="/cis580/13-basic-3d-rendering/03-rendering-a-textured-quad/index.html">3. Rendering a Textured Quad</a></li>
            <li class="" data-nav-id="/cis580/13-basic-3d-rendering/04-rendering-a-cube/index.html"><a class="padding" href="/cis580/13-basic-3d-rendering/04-rendering-a-cube/index.html">4. Rendering a Cube</a></li>
            <li class="" data-nav-id="/cis580/13-basic-3d-rendering/05-summary/index.html"><a class="padding" href="/cis580/13-basic-3d-rendering/05-summary/index.html">5. Summary</a></li></ul></li>
            <li class="" data-nav-id="/cis580/14-lighting-and-cameras/index.html"><input type="checkbox" id="R-section-88e87108c91d62ae7a930bcf4216f175" aria-controls="R-subsections-88e87108c91d62ae7a930bcf4216f175"><label for="R-section-88e87108c91d62ae7a930bcf4216f175"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Lighting and Cameras</span></label><a class="padding" href="/cis580/14-lighting-and-cameras/index.html">14. Lighting and Cameras</a><ul id="R-subsections-88e87108c91d62ae7a930bcf4216f175" class="collapsible-menu">
            <li class="" data-nav-id="/cis580/14-lighting-and-cameras/01-introduction/index.html"><a class="padding" href="/cis580/14-lighting-and-cameras/01-introduction/index.html">1. Introduction</a></li>
            <li class="" data-nav-id="/cis580/14-lighting-and-cameras/02-adding-a-crate/index.html"><a class="padding" href="/cis580/14-lighting-and-cameras/02-adding-a-crate/index.html">2. Adding a Crate</a></li>
            <li class="" data-nav-id="/cis580/14-lighting-and-cameras/03-adding-lights/index.html"><a class="padding" href="/cis580/14-lighting-and-cameras/03-adding-lights/index.html">3. Adding Lights</a></li>
            <li class="" data-nav-id="/cis580/14-lighting-and-cameras/04-adding-a-camera/index.html"><a class="padding" href="/cis580/14-lighting-and-cameras/04-adding-a-camera/index.html">4. Adding a Camera</a></li>
            <li class="" data-nav-id="/cis580/14-lighting-and-cameras/05-more-crates/index.html"><a class="padding" href="/cis580/14-lighting-and-cameras/05-more-crates/index.html">5. More Crates!</a></li>
            <li class="" data-nav-id="/cis580/14-lighting-and-cameras/06-fps-camera/index.html"><a class="padding" href="/cis580/14-lighting-and-cameras/06-fps-camera/index.html">6. FPS Camera</a></li>
            <li class="" data-nav-id="/cis580/14-lighting-and-cameras/07-summary/index.html"><a class="padding" href="/cis580/14-lighting-and-cameras/07-summary/index.html">7. Summary</a></li></ul></li>
            <li class="" data-nav-id="/cis580/15-heightmap-terrain/index.html"><input type="checkbox" id="R-section-fb45254267a6b114e3b70c2fff76792a" aria-controls="R-subsections-fb45254267a6b114e3b70c2fff76792a"><label for="R-section-fb45254267a6b114e3b70c2fff76792a"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Heightmap Terrain</span></label><a class="padding" href="/cis580/15-heightmap-terrain/index.html">15. Heightmap Terrain</a><ul id="R-subsections-fb45254267a6b114e3b70c2fff76792a" class="collapsible-menu">
            <li class="" data-nav-id="/cis580/15-heightmap-terrain/01-introduction/index.html"><a class="padding" href="/cis580/15-heightmap-terrain/01-introduction/index.html">1. Introduction</a></li>
            <li class="" data-nav-id="/cis580/15-heightmap-terrain/02-heightmaps/index.html"><a class="padding" href="/cis580/15-heightmap-terrain/02-heightmaps/index.html">2. Heightmaps</a></li>
            <li class="" data-nav-id="/cis580/15-heightmap-terrain/03-terrain-class/index.html"><a class="padding" href="/cis580/15-heightmap-terrain/03-terrain-class/index.html">3. Terrain Class</a></li>
            <li class="" data-nav-id="/cis580/15-heightmap-terrain/04-using-the-terrain/index.html"><a class="padding" href="/cis580/15-heightmap-terrain/04-using-the-terrain/index.html">4. Using the Terrain</a></li>
            <li class="" data-nav-id="/cis580/15-heightmap-terrain/05-interpolating-heights/index.html"><a class="padding" href="/cis580/15-heightmap-terrain/05-interpolating-heights/index.html">5. Interpolating Heights</a></li>
            <li class="" data-nav-id="/cis580/15-heightmap-terrain/06-summary/index.html"><a class="padding" href="/cis580/15-heightmap-terrain/06-summary/index.html">6. Summary</a></li></ul></li>
            <li class="" data-nav-id="/cis580/16-models/index.html"><input type="checkbox" id="R-section-9746aea227b97b0bb880acb9e9f0be71" aria-controls="R-subsections-9746aea227b97b0bb880acb9e9f0be71"><label for="R-section-9746aea227b97b0bb880acb9e9f0be71"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Models</span></label><a class="padding" href="/cis580/16-models/index.html">16. Models</a><ul id="R-subsections-9746aea227b97b0bb880acb9e9f0be71" class="collapsible-menu">
            <li class="" data-nav-id="/cis580/16-models/01-introduction/index.html"><a class="padding" href="/cis580/16-models/01-introduction/index.html">1. Introduction</a></li>
            <li class="" data-nav-id="/cis580/16-models/02-model-basics/index.html"><a class="padding" href="/cis580/16-models/02-model-basics/index.html">2. Model Basics</a></li>
            <li class="" data-nav-id="/cis580/16-models/03-tank-class/index.html"><a class="padding" href="/cis580/16-models/03-tank-class/index.html">3. Tank Class</a></li>
            <li class="" data-nav-id="/cis580/16-models/04-skeletal-animation/index.html"><a class="padding" href="/cis580/16-models/04-skeletal-animation/index.html">4. Skeletal Animation</a></li>
            <li class="" data-nav-id="/cis580/16-models/05-chase-camera/index.html"><a class="padding" href="/cis580/16-models/05-chase-camera/index.html">5. Chase Camera</a></li>
            <li class="" data-nav-id="/cis580/16-models/06-summary/index.html"><a class="padding" href="/cis580/16-models/06-summary/index.html">6. Summary</a></li></ul></li>
            <li class="" data-nav-id="/cis580/a-simple-games/index.html"><input type="checkbox" id="R-section-6b22de0ab14fc3446f79396185815d11" aria-controls="R-subsections-6b22de0ab14fc3446f79396185815d11"><label for="R-section-6b22de0ab14fc3446f79396185815d11"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Simple Games</span></label><a class="padding" href="/cis580/a-simple-games/index.html">A. Simple Games</a><ul id="R-subsections-6b22de0ab14fc3446f79396185815d11" class="collapsible-menu">
            <li class="" data-nav-id="/cis580/a-simple-games/01-introduction/index.html"><a class="padding" href="/cis580/a-simple-games/01-introduction/index.html">1. Introduction</a></li>
            <li class="" data-nav-id="/cis580/a-simple-games/02-snake/index.html"><a class="padding" href="/cis580/a-simple-games/02-snake/index.html">2. Snake</a></li>
            <li class="" data-nav-id="/cis580/a-simple-games/03-flappy-bird/index.html"><a class="padding" href="/cis580/a-simple-games/03-flappy-bird/index.html">3. Flappy Bird</a></li>
            <li class="" data-nav-id="/cis580/a-simple-games/04-one-tap-quest/index.html"><a class="padding" href="/cis580/a-simple-games/04-one-tap-quest/index.html">4. One-Tap Quest</a></li></ul></li>
            <li class="" data-nav-id="/cis580/b-game-math/index.html"><input type="checkbox" id="R-section-ce26564e693e8e850e62194000433be8" aria-controls="R-subsections-ce26564e693e8e850e62194000433be8"><label for="R-section-ce26564e693e8e850e62194000433be8"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Game Math</span></label><a class="padding" href="/cis580/b-game-math/index.html">B. Game Math</a><ul id="R-subsections-ce26564e693e8e850e62194000433be8" class="collapsible-menu">
            <li class="" data-nav-id="/cis580/b-game-math/01-introduction/index.html"><a class="padding" href="/cis580/b-game-math/01-introduction/index.html">1. Introduction</a></li>
            <li class="" data-nav-id="/cis580/b-game-math/02-coordinate-systems/index.html"><a class="padding" href="/cis580/b-game-math/02-coordinate-systems/index.html">2. Coordinate Systems</a></li>
            <li class="" data-nav-id="/cis580/b-game-math/03-trigonometry/index.html"><a class="padding" href="/cis580/b-game-math/03-trigonometry/index.html">3. Trigonometry</a></li>
            <li class="" data-nav-id="/cis580/b-game-math/04-vectors/index.html"><a class="padding" href="/cis580/b-game-math/04-vectors/index.html">4. Vectors</a></li></ul></li>
          </ul>
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-shortcuts">
          <ul class="space collapsible-menu">
          </ul>
        </div>
        <div id="R-footer-margin"></div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-footercontrols">
          <ul class="">
            <li class="R-variantswitcher">
              <div class="padding menu-control">
                <i class="fa-fw fas fa-paint-brush"></i>
                <span>&nbsp;</span>
                <div class="control-style">
                  <label class="a11y-only" for="R-select-variant">Theme</label>
                  <select id="R-select-variant">
                    <option id="R-select-variant-auto" value="auto" selected>KSU Auto</option>
                    <option id="R-select-variant-light-theme" value="light-theme">KSU Light</option>
                    <option id="R-select-variant-dark-theme" value="dark-theme">KSU Dark</option>
                  </select>
                </div>
                <div class="clear"></div>
              </div>
              <script>window.relearn.markVariant();</script>
            </li>
          </ul>
        </div>
<div id="R-footer"><p>Built using <a href="http://gohugo.io/">Hugo</a> and <a href="https://github.com/ksu-cs-textbooks/hugo-theme-relearn">Hugo Relearn Theme</a>.</p>
<p><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0; margin: .5rem auto" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License.</a></p></div>
      </div>
    </aside>
    <script src="/cis580/js/clipboard/clipboard.min.js?1755628803" defer></script>
    <script src="/cis580/js/perfect-scrollbar/perfect-scrollbar.min.js?1755628803" defer></script>
    <script src="/cis580/js/theme.min.js?1755628803" defer></script>
  </body>
</html>
