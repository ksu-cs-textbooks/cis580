




	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.117.0">
    <meta name="generator" content="Relearn 5.18.0">
    <meta name="description" content="K-State CIS 580 Textbook">
    <meta name="author" content="Nathan H. Bean">
    <title>Elastic Collisions :: K-State CIS 580 Textbook</title>
    <link href="https://ksu-cs-textbooks.github.io/cis580/06-physics/04-elastic-collisions/index.html" rel="canonical" type="text/html" title="Elastic Collisions :: K-State CIS 580 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis580/06-physics/04-elastic-collisions/index.xml" rel="alternate" type="application/rss+xml" title="Elastic Collisions :: K-State CIS 580 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis580/06-physics/04-elastic-collisions/index.print.html" rel="alternate" type="text/html" title="Elastic Collisions :: K-State CIS 580 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis580/06-physics/04-elastic-collisions/tele.html" rel="alternate" type="text/html" title="Elastic Collisions :: K-State CIS 580 Textbook">
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/fontawesome-all.min.css?1692031296" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis580/css/fontawesome-all.min.css?1692031296" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/nucleus.css?1692031296" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/auto-complete.css?1692031296" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis580/css/auto-complete.css?1692031296" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/perfect-scrollbar.min.css?1692031296" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/fonts.css?1692031296" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis580/css/fonts.css?1692031296" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/theme.css?1692031296" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/theme-auto.css?1692031296" rel="stylesheet" id="variant-style">
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/variant.css?1692031296" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/print.css?1692031296" rel="stylesheet" media="print">
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/ie.css?1692031296" rel="stylesheet">
    <script src="https://ksu-cs-textbooks.github.io/cis580/js/url.js?1692031296"></script>
    <script src="https://ksu-cs-textbooks.github.io/cis580/js/variant.js?1692031296"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="https://ksu-cs-textbooks.github.io/cis580/index.search.js";
      var root_url="https://ksu-cs-textbooks.github.io/cis580/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      window.T_No_results_found = 'No results found for \u0022{0}\u0022';
      window.T_N_results_found = '{1} results found for \u0022{0}\u0022';
      // some further base stuff
      var baseUriFull='https:\/\/ksu-cs-textbooks.github.io\/cis580/';
      window.variants && variants.init( [ 'auto', 'light-theme', 'dark-theme' ] );
    </script>
    
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/custom.css?1692031296" rel="stylesheet">

  </head>
  <body class="mobile-support embed disableInlineCopyToClipboard" data-url="https://ksu-cs-textbooks.github.io/cis580/06-physics/04-elastic-collisions/embed.html">
    <div id="body" class="default-animation">
      
      
      
      <main id="body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
    
    
    
<p>Now that we&rsquo;ve looked at movement derived from both linear and angular dynamics, let&rsquo;s revisit them from the perspective of <em>collisions</em>.  If we have two rigid bodies that collide, what should be the outcome?  Consider an <em>elastic</em> collision (one in which the two objects &ldquo;bounce off&rdquo; one another).  From Newtonian mechanics we know that:</p>
<ol>
<li>Energy must be conserved</li>
<li>Momentum must be conserved</li>
</ol>
<p>Thus, if we consider our two objects in isolation (as a system of two), the total system must have the same energy and momentum <em>after</em> the collision that it had <em>before</em> (Note we are talking about <em>perfectly</em> elastic collisions here - in the real world some energy would be converted to heat and sound).</p>
<p>Momentum is the product of mass and velocity of an object:</p>

<span class="math align-center">$$ \rho = mv\tag{0} $$</span>
<p>Since we have two objects, the total momentum in the system is the sum of those:</p>

<span class="math align-center">$$ \rho = m_1v_1 + m_2v_2\tag{1} $$</span>
<p>And, due to the law of conservation of momentum,</p>

<span class="math align-center">$$ \rho_{before} = \rho_{after} \tag{2} $$</span>
<p>So, substituting equation 1 before and after the collision we find:</p>

<span class="math align-center">$$ m_1u_1 + m_2u_2 = m_1v_1 + m_2v_2\tag{3} $$</span>
<p>Where 
<span class="math align-center">$ u $</span> is the velocity <em>before</em> a collision, and 
<span class="math align-center">$ v $</span> is the velocity <em>after</em> (note that the mass of each object does not change).</p>
<p>And since our objects are both moving, they also have kinetic energy:</p>

<span class="math align-center">$$ E_k = \frac{1}{2}mv^2\tag{4} $$</span>
<p>As energy is conserved, the energy <em>before</em> the collision and <em>after</em> must likewise be conserved:</p>

<span class="math align-center">$$ E_{before} = E_{after} \tag{5} $$</span>
<p>Substituting equation 4 into 5 yields:</p>

<span class="math align-center">$$ \frac{1}{2}m_0u_0^2 + \frac{1}{2}m_1u_1^2 = \frac{1}{2}m_0v_0^2 + \frac{1}{2}m_1v_1^2 \tag{6} $$</span>
<p>Assuming we enter the collision knowing the values of 
<span class="math align-center">$ u_0, u_1, m_0, and m_1 $</span>, we have two unknowns 
<span class="math align-center">$ v_0 $</span> and 
<span class="math align-center">$ v_1 $</span> and two equations containing them (equations 3 and 6).  Thus, we can solve for 
<span class="math align-center">$ v_0 $</span> and 
<span class="math align-center">$ v_1 $</span>:</p>
<p>
<span class="math align-center">$$ v_0 = \frac{m_0 - m_1}{m_0 + m_1}u_0 + \frac{2m_1}{m_0+m_1}u_1 \tag{7} $$</span>

<span class="math align-center">$$ v_1 = \frac{2m_0}{m_0+m_1}u_0 + \frac{m_1 - m_0}{m_0 + m_1}u_1 \tag{8} $$</span></p>
<p>These two equations can give us the new velocities in a single dimension.  But we&rsquo;re primarily interested in <em>two</em> dimensions, and our velocities are expressed as <code>Vector2</code> objects.  However, there is a simple solution; use a coordinate system that aligns with the axis of collision, i.e. for two masses colliding, A and B:</p>
<p>
<a href="#image-47a90de2a0e807a70c1f23c9b9737bd8" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis580/images/6.4.1.png" alt="Aligning the coordinate system with the axis of collision" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-47a90de2a0e807a70c1f23c9b9737bd8">
<img src="https://ksu-cs-textbooks.github.io/cis580/images/6.4.1.png" alt="Aligning the coordinate system with the axis of collision" class="lightbox-image" loading="lazy">
</a></p>
<p>Note how the X-axis in the diagram is aligned with the line between the centers of mass A and B.  We can accomplish this in code by calculating the vector between the center of the two bodies, and determining the angle between that vector and the x-Axis:</p>
<p>
<a href="#image-7047165262bb97d278a525fd2f5c9fc8" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis580/images/6.4.2.png" alt="Finding the angle between the line of collision and x-axis" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-7047165262bb97d278a525fd2f5c9fc8">
<img src="https://ksu-cs-textbooks.github.io/cis580/images/6.4.2.png" alt="Finding the angle between the line of collision and x-axis" class="lightbox-image" loading="lazy">
</a></p>
<p>Remember that the angle between two vectors is related to the dot product:</p>

<span class="math align-center">$$ cos\theta = \frac{ a \cdotp b}{||a||*||b||} \tag {9} $$</span>
<p>If both vectors 
<span class="math align-center">$ a $</span> and 
<span class="math align-center">$ b $</span> are of unit length (normalized), then this simplifies to:</p>

<span class="math align-center">$$ cos\theta = a \cdotp b \tag {10} $$</span>
<p>And 
<span class="math align-center">$ \theta $</span> can be solved for by:</p>

<span class="math align-center">$$ \theta = cos^{-1}(a \cdotp b) \tag{11} $$</span>
<p>Given two rigid bodies <code>A</code> and <code>B</code>, we could then calculate this angle using their centers:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">// Determine the line between centers of colliding objects A and B</span>
</span></span><span style="display:flex;"><span>Vector2 collisionLine = A.Center - B.Center;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Normalize that line</span>
</span></span><span style="display:flex;"><span>collisionLine.Normalize();
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Determine the angle between the collision line and the x-axis</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">float</span> angle = Math.Acos(Vector2.Dot(collisionLine, Vector2.UnitX));</span></span></code></pre></div><p>Once we have this angle, we can rotate our velocity vectors using it, so that the coordinate system now aligns with that axis:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>Vector2 u0 = Vector2.Transform(Matrix.CreateRotationZ(A.Velocity, angle));
</span></span><span style="display:flex;"><span>Vector2 u1 = Vector2.Transform(Matrix.CreateRotationZ(B.Velocity, angle));</span></span></code></pre></div><p>We can use these values, along with the masses of the two objects, to calculate the changes in the X-component of the velocity using equations (7) and (8):</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">float</span> m0 = A.Mass;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">float</span> m1 = B.Mass;
</span></span><span style="display:flex;"><span>Vector2 v0;
</span></span><span style="display:flex;"><span>v0.X = ((m0 - m1) / (m0 + m1)) * u0.X + ((<span style="color:#ae81ff">2</span> * m1) / (m0 + m1)) * u1.X;
</span></span><span style="display:flex;"><span>Vector2 v1;
</span></span><span style="display:flex;"><span>v1.X = ((<span style="color:#ae81ff">2</span> * m0) / (m0 + m1)) * u0.X + ((m1 - m0) / (m0 + m1)) * u1.X;</span></span></code></pre></div><p>And, because the collision axis and the x-axis are the same, this transfer of velocity <em>only</em> occurs along the x-axis.  The y components stay the same!</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>v0.Y = u0.Y;
</span></span><span style="display:flex;"><span>v1.Y = u0.Y;</span></span></code></pre></div><p>Then, we can rotate the velocities back to the original coordinate system and assign the transformed velocities to our bodies:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>A.Velocity = Vector2.Transform(v0, Matrix.CreateRotationZ(-angle));
</span></span><span style="display:flex;"><span>B.Velocity = Vector2.Transform(v1, Matrix.CreateRotationZ(-angle));</span></span></code></pre></div><p>Some notes on this process:</p>
<ol>
<li>
<p>at this point we are not accounting for when the collision has gone some way into the bodies; it is possible that after velocity is transferred one will be &ldquo;stuck&rdquo; inside the other.  A common approach to avoid this is to move the two apart based on how much overlap there is.  A more accurate and costly approach is to calculate the time from the moment of impact until end of frame, move the bodies with the inverse of their original velocities multiplied by this delta t, and then apply the <em>new</em> velocities for the same delta t.</p>
</li>
<li>
<p>this approach only works on two bodies at a time.  If you have three or more colliding, the common approach is to solve for each pair in the collision multiple times until they are not colliding.  This is not accurate, but gives a reasonable approximation in many cases.</p>
</li>
</ol>

            <footer class="footline">

            </footer>
          </article>
        </div>
      </main>
    </div>
    
    
    
    <script src="https://ksu-cs-textbooks.github.io/cis580/js/clipboard.min.js?1692031296" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cis580/js/perfect-scrollbar.min.js?1692031296" defer></script>
    <script>
      function useMathJax( config ){
        if( !Object.assign ){
          
          return;
        }
        window.MathJax = Object.assign( window.MathJax || {}, {
          loader: {
            load: ['[tex]/mhchem']
          },
          startup: {
            elements: [
              '.math'
            ]
          },
          tex: {
            inlineMath: [
              ['$', '$'], 
              ['\\(', '\\)']
            ]
          },
          options: {
            enableMenu: false 
          }
        }, config );
      }
      useMathJax( JSON.parse("{}") );
    </script>
    <script id="MathJax-script" async src="https://ksu-cs-textbooks.github.io/cis580/js/mathjax/tex-mml-chtml.js?1692031296"></script>
    <script src="https://ksu-cs-textbooks.github.io/cis580/js/theme.js?1692031296" defer></script>
  </body>
</html>
