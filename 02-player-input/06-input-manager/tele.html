




  
	
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.128.0">
    <meta name="generator" content="Relearn 6.0.0">
    <meta name="description" content="At this point, you may be noticing that our input processing could quickly dominate our Game class, and can be very messy. Especially if we want to support multiple forms of input in the same game. Consider if we wanted to do a platformer - we might want the player to be able to use the keyboard or a gamepad.
One technique we can employ is an input manager, a class that handles polling the input and abstracts it to just the commands we care about.">
    <meta name="author" content="Nathan Bean">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Input Manager :: K-State CIS 580 Textbook">
    <meta name="twitter:description" content="At this point, you may be noticing that our input processing could quickly dominate our Game class, and can be very messy. Especially if we want to support multiple forms of input in the same game. Consider if we wanted to do a platformer - we might want the player to be able to use the keyboard or a gamepad.
One technique we can employ is an input manager, a class that handles polling the input and abstracts it to just the commands we care about.">
    <meta property="og:url" content="https://textbooks.cs.ksu.edu/cis580/02-player-input/06-input-manager/">
    <meta property="og:site_name" content="K-State CIS 580 Textbook">
    <meta property="og:title" content="Input Manager :: K-State CIS 580 Textbook">
    <meta property="og:description" content="At this point, you may be noticing that our input processing could quickly dominate our Game class, and can be very messy. Especially if we want to support multiple forms of input in the same game. Consider if we wanted to do a platformer - we might want the player to be able to use the keyboard or a gamepad.
One technique we can employ is an input manager, a class that handles polling the input and abstracts it to just the commands we care about.">
    <meta property="og:locale" content="en-us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Player Input">
    <meta property="article:published_time" content="2018-08-24T10:53:26-05:00">
    <meta property="article:modified_time" content="2023-08-14T11:41:07-05:00">
    <meta itemprop="name" content="Input Manager :: K-State CIS 580 Textbook">
    <meta itemprop="description" content="At this point, you may be noticing that our input processing could quickly dominate our Game class, and can be very messy. Especially if we want to support multiple forms of input in the same game. Consider if we wanted to do a platformer - we might want the player to be able to use the keyboard or a gamepad.
One technique we can employ is an input manager, a class that handles polling the input and abstracts it to just the commands we care about.">
    <meta itemprop="datePublished" content="2018-08-24T10:53:26-05:00">
    <meta itemprop="dateModified" content="2023-08-14T11:41:07-05:00">
    <meta itemprop="wordCount" content="601">
    <title>Input Manager :: K-State CIS 580 Textbook</title>
    <link href="https://textbooks.cs.ksu.edu/cis580/02-player-input/06-input-manager/" rel="canonical" type="text/html" title="Input Manager :: K-State CIS 580 Textbook">
    <link href="/cis580/02-player-input/06-input-manager/index.xml" rel="alternate" type="application/rss+xml" title="Input Manager :: K-State CIS 580 Textbook">
    <link href="/cis580/02-player-input/06-input-manager/index.print.html" rel="alternate" type="text/html" title="Input Manager :: K-State CIS 580 Textbook">
    <link href="/cis580/02-player-input/06-input-manager/embed.html" rel="alternate" type="text/html" title="Input Manager :: K-State CIS 580 Textbook">
    <link href="/cis580/css/fontawesome-all.min.css?1723670681" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/cis580/css/fontawesome-all.min.css?1723670681" rel="stylesheet"></noscript>
    <link href="/cis580/css/nucleus.css?1723670681" rel="stylesheet">
    <link href="/cis580/css/auto-complete.css?1723670681" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/cis580/css/auto-complete.css?1723670681" rel="stylesheet"></noscript>
    <link href="/cis580/css/perfect-scrollbar.min.css?1723670681" rel="stylesheet">
    <link href="/cis580/css/fonts.css?1723670681" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/cis580/css/fonts.css?1723670681" rel="stylesheet"></noscript>
    <link href="/cis580/css/theme.css?1723670681" rel="stylesheet">
    <link href="/cis580/css/theme-auto.css?1723670681" rel="stylesheet" id="R-variant-style">
    <link href="/cis580/css/chroma-auto.css?1723670681" rel="stylesheet" id="R-variant-chroma-style">
    <link href="/cis580/css/variant.css?1723670681" rel="stylesheet">
    <link href="/cis580/css/print.css?1723670681" rel="stylesheet" media="print">
    <script src="/cis580/js/variant.js?1723670681"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='..\/..';
      window.relearn.relBaseUri='..\/..\/..';
      window.relearn.absBaseUri='https:\/\/textbooks.cs.ksu.edu\/cis580';
      window.index_js_url="/cis580/index.search.js";
      // variant stuff
      window.variants && variants.init( [ 'auto', 'light-theme', 'dark-theme' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script>
    
    <link href="/cis580/css/custom.css?1723670681" rel="stylesheet">
  </head>
  <body class="mobile-support tele disableInlineCopyToClipboard" data-url="/cis580/02-player-input/06-input-manager/">
    
    <div id="tele" class="tele mirror">
    
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      
      
      
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>

<h1 id="input-manager">Input Manager</h1>

<p>At this point, you may be noticing that our input processing could quickly dominate our <code>Game</code> class, and can be very messy.  Especially if we want to support multiple forms of input in the same game.  Consider if we wanted to do a platformer - we might want the player to be able to use the keyboard <em>or</em> a gamepad.</p>
<p>One technique we can employ is an <em>input manager</em>, a class that handles polling the input and abstracts it to just the commands we care about.  I.e. for a simple platformer, we might want the four directions and &ldquo;jump&rdquo;.</p>
<p>We can create a class called <em>InputManager</em> that would provide those:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Microsoft.Xna.Framework</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Microsoft.Xna.Framework.Input</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// Manages input for a simple platformer</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="k">class</span> <span class="nc">InputManager</span> 
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// The player&#39;s direction</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">Vector2</span> <span class="n">Direction</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="kd">private</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// If the player pressed jump this frame </span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">bool</span> <span class="n">Jump</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="kd">private</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><p>Note that we use <code>public</code> auto-properties, but override the <code>set</code> to be <code>private</code>.  This way outside code can access these boolean properties, but only the code in this class can set them.</p>
<p>We&rsquo;ll also need to declare our state variables:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="cs">/// Input state variables</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">KeyboardState</span> <span class="n">currentKeyboardState</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">KeyboardState</span> <span class="n">priorKeyboardState</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">GamePadState</span> <span class="n">currentGamePadState</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">GamePadState</span> <span class="n">priorGamePadState</span><span class="p">;</span></span></span></code></pre></div><p>And, we&rsquo;ll process these in an update method:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Update the input object</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;gameTime&#34;&gt;The game time&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">void</span> <span class="n">Update</span><span class="p">(</span><span class="n">GameTime</span> <span class="n">gameTime</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Update input state</span>
</span></span><span class="line"><span class="cl">        <span class="n">priorKeyboardState</span> <span class="p">=</span> <span class="n">currentKeyboardState</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">currentKeyboardState</span> <span class="p">=</span> <span class="n">Keyboard</span><span class="p">.</span><span class="n">GetState</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">priorGamePadState</span> <span class="p">=</span> <span class="n">currentGamePadState</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">currentGamePadState</span> <span class="p">=</span> <span class="n">GamePad</span><span class="p">.</span><span class="n">GetState</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// TODO: Assign actions based on input</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span></span></span></code></pre></div><p>This looks just like how we updated state before.  The next step is to abstract the input <em>into</em> the properties we defined.  We&rsquo;ll start with the <code>Direction</code>, which we are using a <code>Vector2</code> to represent.  This conveniently matches with our gamepad&rsquo;s thumbstick representation, so we can assign it directly:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="c1">// Right thumbstick</span>
</span></span><span class="line"><span class="cl">    <span class="n">Direction</span> <span class="p">=</span> <span class="n">currentGamePadState</span><span class="p">.</span><span class="n">Thumbsticks</span><span class="p">.</span><span class="n">Right</span><span class="p">;</span></span></span></code></pre></div><p>If there is no gamepad available, this will be the vector 
<span class="math align-center">$ (0,0) $</span>.  Then we can check the WASD keys, and assign a corresponding value</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="c1">// WASD keys:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">currentKeyboardState</span><span class="p">.</span><span class="n">IsKeyDown</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="n">W</span><span class="p">))</span> <span class="n">Direction</span> <span class="p">+=</span> <span class="k">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="m">0</span><span class="p">,-</span><span class="m">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">currentKeyboardState</span><span class="p">.</span><span class="n">IsKeyDown</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="n">A</span><span class="p">))</span> <span class="n">Direction</span> <span class="p">+=</span> <span class="k">new</span> <span class="n">Vector2</span><span class="p">(-</span><span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">currentKeyboardState</span><span class="p">.</span><span class="n">IsKeyDown</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="n">S</span><span class="p">))</span> <span class="n">Direction</span> <span class="p">+=</span> <span class="k">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">currentKeyboardState</span><span class="p">.</span><span class="n">IsKeyDown</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="n">D</span><span class="p">))</span> <span class="n">Direction</span> <span class="p">+=</span> <span class="k">new</span> <span class="n">Vector2</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span></span></span></code></pre></div><p>Note that we are adding a unit vector to the (supposedly zero) existing vector.  This does mean that a player using <em>both</em> keyboard and mouse could double the direction vector length, so if this is important in your game you&rsquo;ll need additional logic to prevent it.</p>
<p>For the <em>jump</em>, we want that to be a discrete push, i.e. it is only <code>true</code> the frame the button is pushed.  So we&rsquo;ll first need to reset it to false (in case it was true in a prior frame):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="c1">// reset jump</span>
</span></span><span class="line"><span class="cl">    <span class="n">Jump</span> <span class="p">=</span> <span class="kc">false</span><span class="p">;</span></span></span></code></pre></div><p>Now we can check if the &ldquo;A&rdquo; button is pressed:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">currentGamePadState</span><span class="p">.</span><span class="n">IsButtonDown</span><span class="p">(</span><span class="n">Buttons</span><span class="p">.</span><span class="n">A</span><span class="p">)</span> <span class="p">&amp;&amp;</span>  <span class="n">priorGamePadState</span><span class="p">.</span><span class="n">IsButtonUp</span><span class="p">(</span><span class="n">Buttons</span><span class="p">.</span><span class="n">A</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">Jump</span> <span class="p">=</span> <span class="kc">true</span><span class="p">;</span></span></span></code></pre></div><p>Similarly, we can check for the spacebar:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">currentKeyboardState</span><span class="p">.</span><span class="n">IsKeyDown</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="n">Space</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="n">priorKeyboardState</span><span class="p">.</span><span class="n">IsKeyUp</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="n">Space</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">Jump</span> <span class="p">=</span> <span class="kc">true</span><span class="p">;</span></span></span></code></pre></div><p>Now, we just need to construct an instance of <code>InputManager</code> in our game, invoke its <code>Update()</code> at the start of our game class&rsquo; <code>Update()</code> method, and then we can use the <code>Direction</code> and <code>Jump</code> properties to determine what should happen in our game.</p>
<p>This idea can be adapted to any game you want to make - but it will always be specific to the game, as what the controls need to do will vary from game to game.  It also makes it easier to allow for multiple forms of input, and to also do user-controlled <em>input mapping</em>, where users can reassign keys/buttons to corresponding actions.</p>

            <footer class="footline">
              
              
              
              
            </footer>
          </article>
</div>
</main>
</div>

</div>




<script src="/cis580/js/clipboard.min.js?1723670681" defer></script>
<script src="/cis580/js/perfect-scrollbar.min.js?1723670681" defer></script>
    <script>
      function useMathJax( config ){
        window.MathJax = Object.assign( window.MathJax || {}, {
          tex: {
            inlineMath:  [['\\(', '\\)'], ['$',  '$']],  
            displayMath: [['\\[', '\\]'], ['$$', '$$']], 
          },
          options: {
            enableMenu: false 
          }
        }, config );
      }
      useMathJax( JSON.parse("{}") );
    </script>
    <script id="MathJax-script" async src="/cis580/js/mathjax/tex-mml-chtml.js?1723670681"></script>
<script src="/cis580/js/theme.js?1723670681" defer></script>

<script src="/cis580/js/tele-scroll.js?1723670681" defer></script>

</body>
</html>
