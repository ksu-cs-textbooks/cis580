




	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.117.0">
    <meta name="generator" content="Relearn 5.18.0">
    <meta name="description" content="K-State CIS 580 Textbook">
    <meta name="author" content="Nathan H. Bean">
    <title>Input Manager :: K-State CIS 580 Textbook</title>
    <link href="https://ksu-cs-textbooks.github.io/cis580/02-player-input/06-input-manager/index.html" rel="canonical" type="text/html" title="Input Manager :: K-State CIS 580 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis580/02-player-input/06-input-manager/index.xml" rel="alternate" type="application/rss+xml" title="Input Manager :: K-State CIS 580 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis580/02-player-input/06-input-manager/index.print.html" rel="alternate" type="text/html" title="Input Manager :: K-State CIS 580 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis580/02-player-input/06-input-manager/tele.html" rel="alternate" type="text/html" title="Input Manager :: K-State CIS 580 Textbook">
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/fontawesome-all.min.css?1691771330" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis580/css/fontawesome-all.min.css?1691771330" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/nucleus.css?1691771330" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/auto-complete.css?1691771330" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis580/css/auto-complete.css?1691771330" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/perfect-scrollbar.min.css?1691771330" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/fonts.css?1691771330" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis580/css/fonts.css?1691771330" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/theme.css?1691771330" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/theme-auto.css?1691771330" rel="stylesheet" id="variant-style">
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/variant.css?1691771330" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/print.css?1691771330" rel="stylesheet" media="print">
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/ie.css?1691771330" rel="stylesheet">
    <script src="https://ksu-cs-textbooks.github.io/cis580/js/url.js?1691771330"></script>
    <script src="https://ksu-cs-textbooks.github.io/cis580/js/variant.js?1691771330"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="https://ksu-cs-textbooks.github.io/cis580/index.search.js";
      var root_url="https://ksu-cs-textbooks.github.io/cis580/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      window.T_No_results_found = 'No results found for \u0022{0}\u0022';
      window.T_N_results_found = '{1} results found for \u0022{0}\u0022';
      // some further base stuff
      var baseUriFull='https:\/\/ksu-cs-textbooks.github.io\/cis580/';
      window.variants && variants.init( [ 'auto', 'light-theme', 'dark-theme' ] );
    </script>
    
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/custom.css?1691771330" rel="stylesheet">

  </head>
  <body class="mobile-support embed disableInlineCopyToClipboard" data-url="https://ksu-cs-textbooks.github.io/cis580/02-player-input/06-input-manager/embed.html">
    <div id="body" class="default-animation">
      
      
      
      <main id="body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
    
    
    
<p>At this point, you may be noticing that our input processing could quickly dominate our <code>Game</code> class, and can be very messy.  Especially if we want to support multiple forms of input in the same game.  Consider if we wanted to do a platformer - we might want the player to be able to use the keyboard <em>or</em> a gamepad.</p>
<p>One technique we can employ is an <em>input manager</em>, a class that handles polling the input and abstracts it to just the commands we care about.  I.e. for a simple platformer, we might want the four directions and &ldquo;jump&rdquo;.</p>
<p>We can create a class called <em>InputManager</em> that would provide those:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">using</span> Microsoft.Xna.Framework;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> Microsoft.Xna.Framework.Input;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// Manages input for a simple platformer</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">InputManager</span> 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// The player&#39;s direction</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Vector2 Direction { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">set</span>; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// If the player pressed jump this frame </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">bool</span> Jump { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">set</span>; }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>Note that we use <code>public</code> auto-properties, but override the <code>set</code> to be <code>private</code>.  This way outside code can access these boolean properties, but only the code in this class can set them.</p>
<p>We&rsquo;ll also need to declare our state variables:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">/// Input state variables</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> KeyboardState currentKeyboardState;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> KeyboardState priorKeyboardState;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> GamePadState currentGamePadState;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> GamePadState priorGamePadState;</span></span></code></pre></div><p>And, we&rsquo;ll process these in an update method:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// Update the input object</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// &lt;param name=&#34;gameTime&#34;&gt;The game time&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> Update(GameTime gameTime)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Update input state</span>
</span></span><span style="display:flex;"><span>        priorKeyboardState = currentKeyboardState;
</span></span><span style="display:flex;"><span>        currentKeyboardState = Keyboard.GetState();
</span></span><span style="display:flex;"><span>        priorGamePadState = currentGamePadState;
</span></span><span style="display:flex;"><span>        currentGamePadState = GamePad.GetState(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// TODO: Assign actions based on input</span>
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div><p>This looks just like how we updated state before.  The next step is to abstract the input <em>into</em> the properties we defined.  We&rsquo;ll start with the <code>Direction</code>, which we are using a <code>Vector2</code> to represent.  This conveniently matches with our gamepad&rsquo;s thumbstick representation, so we can assign it directly:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">// Right thumbstick</span>
</span></span><span style="display:flex;"><span>    Direction = currentGamePadState.Thumbsticks.Right;</span></span></code></pre></div><p>If there is no gamepad available, this will be the vector $(0,0)$.  Then we can check the WASD keys, and assign a corresponding value</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">// WASD keys:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (currentKeyboardState.IsKeyDown(Keys.W)) Direction += <span style="color:#66d9ef">new</span> Vector2(<span style="color:#ae81ff">0</span>,-<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (currentKeyboardState.IsKeyDown(Keys.A)) Direction += <span style="color:#66d9ef">new</span> Vector2(-<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (currentKeyboardState.IsKeyDown(Keys.S)) Direction += <span style="color:#66d9ef">new</span> Vector2(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (currentKeyboardState.IsKeyDown(Keys.D)) Direction += <span style="color:#66d9ef">new</span> Vector2(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>);</span></span></code></pre></div><p>Note that we are adding a unit vector to the (supposedly zero) existing vector.  This does mean that a player using <em>both</em> keyboard and mouse could double the direction vector length, so if this is important in your game you&rsquo;ll need additional logic to prevent it.</p>
<p>For the <em>jump</em>, we want that to be a discrete push, i.e. it is only <code>true</code> the frame the button is pushed.  So we&rsquo;ll first need to reset it to false (in case it was true in a prior frame):</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">// reset jump</span>
</span></span><span style="display:flex;"><span>    Jump = <span style="color:#66d9ef">false</span>;</span></span></code></pre></div><p>Now we can check if the &ldquo;A&rdquo; button is pressed:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(currentGamePadState.IsButtonDown(Buttons.A) &amp;&amp;  priorGamePadState.IsButtonUp(Buttons.A))
</span></span><span style="display:flex;"><span>        Jump = <span style="color:#66d9ef">true</span>;</span></span></code></pre></div><p>Similarly, we can check for the spacebar:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(currentKeyboardState.IsKeyDown(Keys.Space) &amp;&amp; priorKeyboardState.IsKeyUp(Keys.Space))
</span></span><span style="display:flex;"><span>        Jump = <span style="color:#66d9ef">true</span>;</span></span></code></pre></div><p>Now, we just need to construct an instance of <code>InputManager</code> in our game, invoke its <code>Update()</code> at the start of our game class&rsquo; <code>Update()</code> method, and then we can use the <code>Direction</code> and <code>Jump</code> properties to determine what should happen in our game.</p>
<p>This idea can be adapted to any game you want to make - but it will always be specific to the game, as what the controls need to do will vary from game to game.  It also makes it easier to allow for multiple forms of input, and to also do user-controlled <em>input mapping</em>, where users can reassign keys/buttons to corresponding actions.</p>

            <footer class="footline">

            </footer>
          </article>
        </div>
      </main>
    </div>
    
    
    
    <script src="https://ksu-cs-textbooks.github.io/cis580/js/clipboard.min.js?1691771330" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cis580/js/perfect-scrollbar.min.js?1691771330" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cis580/js/theme.js?1691771330" defer></script>
  </body>
</html>
