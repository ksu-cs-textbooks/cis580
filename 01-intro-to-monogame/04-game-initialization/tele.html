




	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.117.0">
    <meta name="generator" content="Relearn 5.18.0">
    <meta name="description" content="K-State CIS 580 Textbook">
    <meta name="author" content="Nathan H. Bean">
    <title>Game Initialization :: K-State CIS 580 Textbook</title>
    <link href="https://ksu-cs-textbooks.github.io/cis580/01-intro-to-monogame/04-game-initialization/index.html" rel="canonical" type="text/html" title="Game Initialization :: K-State CIS 580 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis580/01-intro-to-monogame/04-game-initialization/index.xml" rel="alternate" type="application/rss+xml" title="Game Initialization :: K-State CIS 580 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis580/01-intro-to-monogame/04-game-initialization/index.print.html" rel="alternate" type="text/html" title="Game Initialization :: K-State CIS 580 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis580/01-intro-to-monogame/04-game-initialization/embed.html" rel="alternate" type="text/html" title="Game Initialization :: K-State CIS 580 Textbook">
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/fontawesome-all.min.css?1691771333" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis580/css/fontawesome-all.min.css?1691771333" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/nucleus.css?1691771333" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/auto-complete.css?1691771333" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis580/css/auto-complete.css?1691771333" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/perfect-scrollbar.min.css?1691771333" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/fonts.css?1691771333" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis580/css/fonts.css?1691771333" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/theme.css?1691771333" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/theme-auto.css?1691771333" rel="stylesheet" id="variant-style">
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/variant.css?1691771333" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/print.css?1691771333" rel="stylesheet" media="print">
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/ie.css?1691771333" rel="stylesheet">
    <script src="https://ksu-cs-textbooks.github.io/cis580/js/url.js?1691771333"></script>
    <script src="https://ksu-cs-textbooks.github.io/cis580/js/variant.js?1691771333"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="https://ksu-cs-textbooks.github.io/cis580/index.search.js";
      var root_url="https://ksu-cs-textbooks.github.io/cis580/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      window.T_No_results_found = 'No results found for \u0022{0}\u0022';
      window.T_N_results_found = '{1} results found for \u0022{0}\u0022';
      // some further base stuff
      var baseUriFull='https:\/\/ksu-cs-textbooks.github.io\/cis580/';
      window.variants && variants.init( [ 'auto', 'light-theme', 'dark-theme' ] );
    </script>
    
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/custom.css?1691771333" rel="stylesheet">

  </head>
  <body class="mobile-support tele disableInlineCopyToClipboard" data-url="https://ksu-cs-textbooks.github.io/cis580/01-intro-to-monogame/04-game-initialization/index.html">
    
    <div id="tele" class="tele mirror">
    
    <div id="body" class="default-animation">
      
      
      
      <main id="body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>
<h1 id="game-initialization">Game Initialization</h1>

<p>Before we actually move into the game loop, we need to <em>initialize</em> the game - load all of its needed parts and set all initial values.  The MonoGame <code>Game</code> class provides two virtual <em>hook</em> methods for doing this: <code>Game.Initialize()</code> and <code>Game.LoadContent()</code>.</p>
<p>You might be wondering why we have <em>two</em> methods, or asking why the constructor is not included in this count.  These are all good questions. First, in the documentation we see that <code>Initialize()</code>:</p>
<blockquote>
<p>Initializes attached GameComponent instances and calls LoadContent().</p>
</blockquote>
<p>And, if we look at the template-generated <code>Game.Initialize()</code> method:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">void</span> Initialize()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// TODO: Add your initialization logic here</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">base</span>.Initialize();
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>We can see that the <code>Game.Initialize()</code> is only invoked <em>after</em> our own initialization logic.  Thus, it is largely a matter of controlling timing.  We only want content (i.e. sounds, textures, etc.) to be loaded once the game is fully initialized.</p>
<p>This is largely because we are using the 3D hardware, which has its own RAM (video memory).  Ideally, textures should be stored there for the fastest and most efficient rendering.  So we want to delay loading our graphics until we have finished configuring the graphics device.  Thus, we do any graphics card configuration in the <code>Initialize()</code> method, <em>before</em> invoking <code>base.Initialize()</code>.</p>
<p>And why not the constructor?  What if we want the player to be able to, upon loosing, immediately restart the game?  If our initialization logic is in <code>Initialize()</code>, we can simply re-invoke that method.  We can&rsquo;t re-construct the <code>Game</code> class though, as it is tied to the life of our application.</p>
<h3 id="a-simple-example">A Simple Example</h3>
<p>Let&rsquo;s look at a super-simple example demonstrating the game loop.  We&rsquo;ll have a ball that moves a bit each frame and bounces off the sides of the window.</p>
<h4 id="variable-declarations">Variable Declarations</h4>
<p>First, we need to know the ball&rsquo;s position and velocity.  In a two-dimensional game, we would probably use a <a href="https://docs.monogame.net/api/Microsoft.Xna.Framework.Vector2.html" target="_blank">Vector2</a>
 Struct to represent these.  We also need a <code>Texture2D</code> to be the image of the ball:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">// The ball&#39;s information</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> Vector2 _ballPosition;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> Vector2 _ballVelocity;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> Texture2D _ballTexture;</span></span></code></pre></div><p>Add these lines to the top of the <code>Game1</code> class definition, along with the other field declarations.</p>
<h4 id="initialize-additions">Initialize() Additions</h4>
<p>Then, in our <code>Initialize()</code> method, let&rsquo;s center the ball on the screen:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">// Position the ball in the center of the screen</span>
</span></span><span style="display:flex;"><span>    _ballPosition.X = GraphicsDevice.Viewport.Width / <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>    _ballPosition.Y = GraphicsDevice.Viewport.Height / <span style="color:#ae81ff">2</span>;</span></span></code></pre></div><p>We&rsquo;ll also give it a random velocity:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>    <span style="color:#75715e">// Give the ball a random velocity</span>
</span></span><span style="display:flex;"><span>    System.Random rand = <span style="color:#66d9ef">new</span> System.Random();
</span></span><span style="display:flex;"><span>    _ballVelocity.X = (<span style="color:#66d9ef">float</span>)rand.NextDouble();
</span></span><span style="display:flex;"><span>    _ballVelocity.Y = (<span style="color:#66d9ef">float</span>)rand.NextDouble();
</span></span><span style="display:flex;"><span>    _ballVelocity.Normalize();
</span></span><span style="display:flex;"><span>    _ballVelocity *= <span style="color:#ae81ff">100</span>;</span></span></code></pre></div><p>For now we&rsquo;ll use the <code>System.Random</code> class you are used to.  For some game purposes, it is sufficient, though its randomness is not as random as we&rsquo;ll need for some kinds of games.  Also, note that because <code>Random.NextDouble()</code> returns a double, and <code>Vector2</code> uses floats, we need to implicitly cast the result.  Finally, <code>Vector2.Normalize()</code> will shorten our velocity vector to be of length $1$, which the <code>_ballVelocity *= 100;</code> line scales up to a length of $100$.  Eventually this will mean our ball will be traveling 100 pixels per second.</p>
<h4 id="adding-the-image-to-the-project">Adding the Image to the Project</h4>
<p>As we said above, <code>LoadContent()</code> is where we load our assets.  For now, we just need an image of a ball.  However, getting this image into our game takes a bit of doing.</p>
<p>First, we need to find an image to use - a .jpeg, .gif, or .png will work fine. Feel free to use this one 
<a href="#image-aba178b32998470127a6e18c984df689" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis580/images/ball.png" alt="a golden ball" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-aba178b32998470127a6e18c984df689">
<img src="https://ksu-cs-textbooks.github.io/cis580/images/ball.png" alt="a golden ball" class="lightbox-image" loading="lazy">
</a>.</p>
<p>Look in the <em>Content</em> folder of your <strong>solution explorer</strong> in Visual Studio.  You should also notice a file, <em>Content.mgcb</em> in the same folder.  This is a listing of all content to bring into the game.  Go ahead and open it; it will look something like:</p>
<p>
<a href="#image-daed05ea2d3ab67a5843848794a8bef4" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis580/images/1.4.1.png" alt="The MGCB Editor" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-daed05ea2d3ab67a5843848794a8bef4">
<img src="https://ksu-cs-textbooks.github.io/cis580/images/1.4.1.png" alt="The MGCB Editor" class="lightbox-image" loading="lazy">
</a></p>

  
  
<div class="box notices cstyle tip">
  <div class="box-label"><i class="fa-fw fas fa-lightbulb"></i> Tip</div>
  <div class="box-content">

<p>If instead of the editor program a text file is loaded in your VisualStudio instance, try right-click the file and choose &ldquo;open with&rdquo;.  From the dialog, choose the <strong>mgcb-editor-wpf</strong>.  If it is not listed, you may need to install it.  From the command line:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&gt; dotnet tool install --global dotnet-mgcb-editor 
</span></span><span style="display:flex;"><span>&gt; mgcb-editor --register</span></span></code></pre></div></div>
</div>
<p>Click the &ldquo;Add Existing Item&rdquo; toolbar button:</p>
<p>
<a href="#image-099e7304ac70dbf2e9e60f094c6f0f40" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis580/images/1.4.2.png" alt="Add Existing Item toolbar button" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-099e7304ac70dbf2e9e60f094c6f0f40">
<img src="https://ksu-cs-textbooks.github.io/cis580/images/1.4.2.png" alt="Add Existing Item toolbar button" class="lightbox-image" loading="lazy">
</a></p>
<p>In the Open dialog that appears, select the ball image and click &ldquo;Open&rdquo;.  Then in the next dialog, choose &ldquo;Copy the file to the directory&rdquo;:</p>
<p>
<a href="#image-220cae233504de6a98712b49876eedef" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis580/images/1.4.3.png" alt="Add File Dialog" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-220cae233504de6a98712b49876eedef">
<img src="https://ksu-cs-textbooks.github.io/cis580/images/1.4.3.png" alt="Add File Dialog" class="lightbox-image" loading="lazy">
</a></p>
<p>Finally, save the .mgcb file:</p>
<p>
<a href="#image-51df70b78733fc99b633229e0abfcd59" class="lightbox-link">
<img src="https://ksu-cs-textbooks.github.io/cis580/images/1.4.4.png" alt="Save the .mgcb file" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-51df70b78733fc99b633229e0abfcd59">
<img src="https://ksu-cs-textbooks.github.io/cis580/images/1.4.4.png" alt="Save the .mgcb file" class="lightbox-image" loading="lazy">
</a></p>
<p>Now the image will be built into a game-specific binary format as part of the build process.  We&rsquo;ll delve deeper into how this works in the chapter on the Content Pipeline.</p>
<h4 id="loadcontent-additions">LoadContent() Additions</h4>
<p>To bring the ball texture into the game, we need to load it with a <code>ContentManager</code> class by invoking the <code>ContentManager.Load&lt;T&gt;()</code> method with the name of our content.  The <code>Game</code> class has one already created and ready in the <code>Game.Content</code> property; we&rsquo;ll use it:</p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>_ballTexture = Content.Load&lt;Texture2D&gt;(<span style="color:#e6db74">&#34;ball&#34;</span>);</span></span></code></pre></div><p>Add this line just below the <code>#TODO: use this.Content to load your game content here</code> line in the <code>LoadContent()</code> method.</p>
<p>Note that we use the filename (sans extension) to identify the content file to load, and that we also specify the type of object it should be loaded as (in this case, <code>Texture2D</code>).</p>
<p>At this point, if we were to run the game everything would be initialized.  Now we need to handle updating and rendering the game world.</p>

            <footer class="footline">

            </footer>
          </article>
        </div>
      </main>
    </div>
    
    </div>
    
    
    
    
    <script src="https://ksu-cs-textbooks.github.io/cis580/js/clipboard.min.js?1691771333" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cis580/js/perfect-scrollbar.min.js?1691771333" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cis580/js/theme.js?1691771333" defer></script>
    
    <script src="https://ksu-cs-textbooks.github.io/cis580/js/tele-scroll.js?1691771333 defer"></script>
    
  </body>
</html>
