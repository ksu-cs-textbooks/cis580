




  
	
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.128.0">
    <meta name="generator" content="Relearn 6.0.0">
    <meta name="description" content="Now that we can see our tank clearly, let’s see if we can’t get that turret to aim. Doing so requires us to explore the concept of skeletal animation. If you remember in our discussion of models, we said most models include both triangle meshes and bones. These “bones” are really just transformation matrices, which are applied to a specific mesh in the model. Often they also are arranged in a hierarchy, often referred to as a skeleton.">
    <meta name="author" content="Nathan Bean">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Skeletal Animation :: K-State CIS 580 Textbook">
    <meta name="twitter:description" content="Now that we can see our tank clearly, let’s see if we can’t get that turret to aim. Doing so requires us to explore the concept of skeletal animation. If you remember in our discussion of models, we said most models include both triangle meshes and bones. These “bones” are really just transformation matrices, which are applied to a specific mesh in the model. Often they also are arranged in a hierarchy, often referred to as a skeleton.">
    <meta property="og:url" content="https://textbooks.cs.ksu.edu/cis580/16-models/04-skeletal-animation/">
    <meta property="og:site_name" content="K-State CIS 580 Textbook">
    <meta property="og:title" content="Skeletal Animation :: K-State CIS 580 Textbook">
    <meta property="og:description" content="Now that we can see our tank clearly, let’s see if we can’t get that turret to aim. Doing so requires us to explore the concept of skeletal animation. If you remember in our discussion of models, we said most models include both triangle meshes and bones. These “bones” are really just transformation matrices, which are applied to a specific mesh in the model. Often they also are arranged in a hierarchy, often referred to as a skeleton.">
    <meta property="og:locale" content="en-us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Models">
    <meta property="article:published_time" content="2020-03-24T10:00:00-05:00">
    <meta property="article:modified_time" content="2021-04-23T16:59:02-05:00">
    <meta itemprop="name" content="Skeletal Animation :: K-State CIS 580 Textbook">
    <meta itemprop="description" content="Now that we can see our tank clearly, let’s see if we can’t get that turret to aim. Doing so requires us to explore the concept of skeletal animation. If you remember in our discussion of models, we said most models include both triangle meshes and bones. These “bones” are really just transformation matrices, which are applied to a specific mesh in the model. Often they also are arranged in a hierarchy, often referred to as a skeleton.">
    <meta itemprop="datePublished" content="2020-03-24T10:00:00-05:00">
    <meta itemprop="dateModified" content="2021-04-23T16:59:02-05:00">
    <meta itemprop="wordCount" content="808">
    <title>Skeletal Animation :: K-State CIS 580 Textbook</title>
    <link href="https://textbooks.cs.ksu.edu/cis580/16-models/04-skeletal-animation/" rel="canonical" type="text/html" title="Skeletal Animation :: K-State CIS 580 Textbook">
    <link href="/cis580/16-models/04-skeletal-animation/index.xml" rel="alternate" type="application/rss+xml" title="Skeletal Animation :: K-State CIS 580 Textbook">
    <link href="/cis580/16-models/04-skeletal-animation/tele.html" rel="alternate" type="text/html" title="Skeletal Animation :: K-State CIS 580 Textbook">
    <link href="/cis580/16-models/04-skeletal-animation/embed.html" rel="alternate" type="text/html" title="Skeletal Animation :: K-State CIS 580 Textbook">
    <link href="/cis580/css/fontawesome-all.min.css?1737133120" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/cis580/css/fontawesome-all.min.css?1737133120" rel="stylesheet"></noscript>
    <link href="/cis580/css/nucleus.css?1737133120" rel="stylesheet">
    <link href="/cis580/css/auto-complete.css?1737133120" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/cis580/css/auto-complete.css?1737133120" rel="stylesheet"></noscript>
    <link href="/cis580/css/perfect-scrollbar.min.css?1737133120" rel="stylesheet">
    <link href="/cis580/css/fonts.css?1737133120" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/cis580/css/fonts.css?1737133120" rel="stylesheet"></noscript>
    <link href="/cis580/css/theme.css?1737133120" rel="stylesheet">
    <link href="/cis580/css/theme-auto.css?1737133120" rel="stylesheet" id="R-variant-style">
    <link href="/cis580/css/chroma-auto.css?1737133120" rel="stylesheet" id="R-variant-chroma-style">
    <link href="/cis580/css/variant.css?1737133120" rel="stylesheet">
    <link href="/cis580/css/print.css?1737133120" rel="stylesheet" media="print">
    <link href="/cis580/css/format-print.css?1737133120" rel="stylesheet">
    <script src="/cis580/js/variant.js?1737133120"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='..\/..';
      window.relearn.relBaseUri='..\/..\/..';
      window.relearn.absBaseUri='https:\/\/textbooks.cs.ksu.edu\/cis580';
      window.index_js_url="/cis580/index.search.js";
      // variant stuff
      window.variants && variants.init( [ 'auto', 'light-theme', 'dark-theme' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script>
    
    <link href="/cis580/css/custom.css?1737133120" rel="stylesheet">
  </head>
  <body class="mobile-support print disableInlineCopyToClipboard" data-url="/cis580/16-models/04-skeletal-animation/">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/cis580/16-models/"><span itemprop="name">Models</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">Skeletal Animation</span><meta itemprop="position" content="2"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/cis580/16-models/03-tank-class/" title="Tank Class (🡐)"><i class="fa-fw fas fa-chevron-left"></i></a>
            </div>
            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/cis580/16-models/05-chase-camera/" title="Chase Camera (🡒)"><i class="fa-fw fas fa-chevron-right"></i></a>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>

<h1 id="skeletal-animation">Skeletal Animation</h1>

<p>Now that we can see our tank clearly, let&rsquo;s see if we can&rsquo;t get that turret to aim. Doing so requires us to explore the concept of <em>skeletal animation</em>.  If you remember in our discussion of models, we said most models include both triangle meshes and <em>bones</em>.  These &ldquo;bones&rdquo; are really just transformation matrices, which are applied to a specific mesh in the model.  Often they also are arranged in a hierarchy, often referred to as a skeleton.  The transformations represented by bones earlier in the hierarchy are concatenated with those lower to compute a final transformation to apply to that mesh.</p>
<p>In our tank, the turret bone is a child of the tank body.  Thus, the turret is transformed by <em>both</em> by the bone of the tank body <em>and</em> the bone of the turret.  Thus, if the tank body moves through the world, the turret comes along for the ride.  Without using this hierarchical approach, we would have to calculate the turret transform based on where the tank currently is, a more challenging proposition.</p>
<h2 id="exposing-the-tanks-transformations">Exposing The Tank&rsquo;s Transformations</h2>
<p>To take advantage of skeletal animation, we&rsquo;ll need to manage the transformations ourselves.  We&rsquo;ll start by declaring an array in the <code>Tank</code> class to hold them:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="c1">// The bone transformation matrices of the tank</span>
</span></span><span class="line"><span class="cl">    <span class="n">Matrix</span><span class="p">[]</span> <span class="n">transforms</span><span class="p">;</span></span></span></code></pre></div><p>We&rsquo;ll initialize this array in our constructor, after we&rsquo;ve loaded the model:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="n">transforms</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Matrix</span><span class="p">[</span><span class="n">model</span><span class="p">.</span><span class="n">Bones</span><span class="p">.</span><span class="n">Count</span><span class="p">];</span></span></span></code></pre></div><p>And in our <code>Tank.Draw()</code> method, we&rsquo;ll apply the model&rsquo;s transforms.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="n">model</span><span class="p">.</span><span class="n">CopyAbsoluteBoneTransformsTo</span><span class="p">(</span><span class="n">transforms</span><span class="p">);</span></span></span></code></pre></div><p>This method walks down the skeleton, concatenating the parent transforms with those of the children bones.  Thus, the transformation matrices in the <code>transforms</code> array after this point are the final transformation that will be applied to the mesh in question.</p>
<p>Then, instead of simply invoking <code>model.draw()</code>, we&rsquo;ll iterate over each mesh, applying its bone transform manually:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="c1">// draw the tank meshes </span>
</span></span><span class="line"><span class="cl">    <span class="k">foreach</span><span class="p">(</span><span class="n">ModelMesh</span> <span class="n">mesh</span> <span class="k">in</span> <span class="n">model</span><span class="p">.</span><span class="n">Meshes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span><span class="p">(</span><span class="n">BasicEffect</span> <span class="n">effect</span> <span class="k">in</span> <span class="n">mesh</span><span class="p">.</span><span class="n">Effects</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">effect</span><span class="p">.</span><span class="n">EnableDefaultLighting</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">effect</span><span class="p">.</span><span class="n">World</span> <span class="p">=</span> <span class="n">bones</span><span class="p">[</span><span class="n">mesh</span><span class="p">.</span><span class="n">ParentBone</span><span class="p">.</span><span class="n">Index</span><span class="p">]</span> <span class="p">*</span> <span class="n">world</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">effect</span><span class="p">.</span><span class="n">View</span> <span class="p">=</span> <span class="n">camera</span><span class="p">.</span><span class="n">View</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">effect</span><span class="p">.</span><span class="n">Projection</span> <span class="p">=</span> <span class="n">camera</span><span class="p">.</span><span class="n">Projection</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">mesh</span><span class="p">.</span><span class="n">Draw</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span></span></span></code></pre></div><p>At this point, our tank will appear exactly as it did before.  These nested loops are pretty much exactly the code that was invoked by <code>model.draw()</code>.  But the default <code>model.draw()</code> does not perform the absolute bone transformation - instead it uses precalculated defaults.  Thus, we must implement this double-loop if we want to use skeletal animation.</p>
<h2 id="rotating-the-turret">Rotating the Turret</h2>
<p>We can rotate the turret by applying a transformation to the bone corresponding to its mesh. This requires us to add some fields to our <code>Tank</code> class.  First, a reference to the bone we want to transform:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="c1">// The turret bone </span>
</span></span><span class="line"><span class="cl">    <span class="n">ModelBone</span> <span class="n">turretBone</span><span class="p">;</span></span></span></code></pre></div><p>We also need to know its original transformation, so let&rsquo;s create a matrix to store that:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="c1">// The original turret transformation</span>
</span></span><span class="line"><span class="cl">    <span class="n">Matrix</span> <span class="n">turretTransform</span><span class="p">;</span></span></span></code></pre></div><p>And we&rsquo;ll also create an angle field to track the turret rotation:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="c1">// The rotation angle of the turret</span>
</span></span><span class="line"><span class="cl">    <span class="kt">float</span> <span class="n">turretRotation</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span></span></span></code></pre></div><p>We still need to know the bone we want to transform.  If we look through the <em>tank.fbx</em> file, we can find it is named &ldquo;turret_geo&rdquo;.  The <a href="https://www.monogame.net/documentation/?page=P_Microsoft_Xna_Framework_Graphics_Model_Bones" rel="external" target="_blank">model.Bones</a> property can be accessed with either an index, or a key string (like a dictionary).</p>
<p>Thus, after the model is loaded in the constructor we can get a reference to our bone from its name, and from that bone get its original transformation:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="c1">// Set the turret fields</span>
</span></span><span class="line"><span class="cl">    <span class="n">turretBone</span> <span class="p">=</span> <span class="n">model</span><span class="p">.</span><span class="n">Bones</span><span class="p">[</span><span class="s">&#34;turret_geo&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">turretTransform</span> <span class="p">=</span> <span class="n">turretBone</span><span class="p">.</span><span class="n">Transform</span><span class="p">;</span></span></span></code></pre></div><p>Then in our <code>Tank.Update()</code>, let&rsquo;s use the left and right arrow keys to rotate the turret.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="c1">// rotate the turret</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">keyboard</span><span class="p">.</span><span class="n">IsKeyDown</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="n">Left</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">turretRotation</span> <span class="p">-=</span> <span class="n">Speed</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">keyboard</span><span class="p">.</span><span class="n">IsKeyDown</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="n">Right</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">turretRotation</span> <span class="p">+=</span> <span class="n">Speed</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span></span></span></code></pre></div><p>Now in the <code>Tank.Draw()</code> method, we need to set the <code>turretBone.Transform</code> to include our rotation:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="c1">// apply turret rotation</span>
</span></span><span class="line"><span class="cl">    <span class="n">turretBone</span><span class="p">.</span><span class="n">Transform</span> <span class="p">=</span> <span class="n">Matrix</span><span class="p">.</span><span class="n">CreateRotationY</span><span class="p">(</span><span class="n">turretRotation</span><span class="p">)</span> <span class="p">*</span> <span class="n">turretTransform</span><span class="p">;</span></span></span></code></pre></div><p>Now if you run the game, you should be able to rotate the turret left and right with the arrow keys!</p>
<h2 id="tilting-the-canon">Tilting the Canon</h2>
<p>We can allow the player to tilt the canon barrel using the up and down keys in much the same fashion.  We&rsquo;ll start by adding corresponding fields to the <code>Tank</code> class: an angle of rotation, the canon bone, and default canon transform:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="c1">// Barrel fields </span>
</span></span><span class="line"><span class="cl">    <span class="n">ModelBone</span> <span class="n">canonBone</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Matrix</span> <span class="n">canonTransform</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">float</span> <span class="n">canonRotation</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span></span></span></code></pre></div><p>And we can populate these in the constructor, once the model is loaded:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="c1">// Set the canon fields</span>
</span></span><span class="line"><span class="cl">    <span class="n">canonBone</span> <span class="p">=</span> <span class="n">model</span><span class="p">.</span><span class="n">Bones</span><span class="p">[</span><span class="s">&#34;canon_geo&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">canonTransform</span> <span class="p">=</span> <span class="n">canonBone</span><span class="p">.</span><span class="n">Transform</span><span class="p">;</span></span></span></code></pre></div><p>In our <code>Tank.Update()</code>, we can increase or decrease the rotation much like we did with the turret:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="c1">// Update the canon angle</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">keyboard</span><span class="p">.</span><span class="n">IsKeyDown</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="n">Up</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">canonRotation</span> <span class="p">-=</span> <span class="n">Speed</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">keyboard</span><span class="p">.</span><span class="n">IsKeyDown</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="n">Down</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">canonRotation</span> <span class="p">+=</span> <span class="n">Speed</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span></span></span></code></pre></div><p>However, we probably don&rsquo;t want an unlimited amount of rotation - or the cannon will rotate right through the turret and tank body!  So let&rsquo;s clamp the final value to a reasonable limit:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="c1">// Limit canon rotation to a reasonable range </span>
</span></span><span class="line"><span class="cl">    <span class="n">canonRotation</span> <span class="p">=</span> <span class="n">MathHelper</span><span class="p">.</span><span class="n">Clamp</span><span class="p">(</span><span class="n">canonRotation</span><span class="p">,</span> <span class="p">-</span><span class="n">MathHelper</span><span class="p">.</span><span class="n">PiOver4</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span></span></span></code></pre></div><p>Finally, we can add the canon rotation to the <code>Tank.Draw()</code> method:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="n">canonBone</span><span class="p">.</span><span class="n">Transform</span> <span class="p">=</span> <span class="n">Matrix</span><span class="p">.</span><span class="n">CreateRotationX</span><span class="p">(</span><span class="n">canonRotation</span><span class="p">)</span> <span class="p">*</span> <span class="n">canonTransform</span><span class="p">;</span></span></span></code></pre></div><p>Now you can drive around the terrain, aiming your cannon wherever you like!</p>

            <footer class="footline">
              
              
              
              
            </footer>
          </article>

        </div>
      </main>
    
<div class="git-footer">
  <p class="theme-version-footer">6.0.0</p>
  <p>Last modified by: 
              <i class='fas fa-user'></i> Nathan Bean
              <i class='fas fa-calendar'></i> <a href="https://github.com/ksu-cs-textbooks/cis580/commit/4d3773599165cabe7fdfd6378d953325c9dc33eb">Apr 23, 2021</a>
  </p>
  </div>
  
    
    </div>
    <script src="/cis580/js/clipboard.min.js?1737133120" defer></script>
    <script src="/cis580/js/perfect-scrollbar.min.js?1737133120" defer></script>
    <script src="/cis580/js/theme.js?1737133120" defer></script>
  </body>
</html>
