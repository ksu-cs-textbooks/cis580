




  
	
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.128.0">
    <meta name="generator" content="Relearn 6.0.0">
    <meta name="description" content="XNA offered a sample building with these ideas that further organized a game into screens that has been ported to MonoGame.This was heavily influenced by Windows Phone, and includes gestures and “tombstoning” support. A more simplified form is presented here. It organizes a game into “screens”, each with its own logic and rendering, such as a menu, puzzle, cutscene, etc.
A scene manager game component manages a stack of these screens, and updates and renders the topmost.">
    <meta name="author" content="Nathan Bean">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Game Screens :: K-State CIS 580 Textbook">
    <meta name="twitter:description" content="XNA offered a sample building with these ideas that further organized a game into screens that has been ported to MonoGame.This was heavily influenced by Windows Phone, and includes gestures and “tombstoning” support. A more simplified form is presented here. It organizes a game into “screens”, each with its own logic and rendering, such as a menu, puzzle, cutscene, etc.
A scene manager game component manages a stack of these screens, and updates and renders the topmost.">
    <meta property="og:url" content="https://textbooks.cs.ksu.edu/cis580/07-game-architecture/04-game-screens/">
    <meta property="og:site_name" content="K-State CIS 580 Textbook">
    <meta property="og:title" content="Game Screens :: K-State CIS 580 Textbook">
    <meta property="og:description" content="XNA offered a sample building with these ideas that further organized a game into screens that has been ported to MonoGame.This was heavily influenced by Windows Phone, and includes gestures and “tombstoning” support. A more simplified form is presented here. It organizes a game into “screens”, each with its own logic and rendering, such as a menu, puzzle, cutscene, etc.
A scene manager game component manages a stack of these screens, and updates and renders the topmost.">
    <meta property="og:locale" content="en-us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Game Architecture">
    <meta property="article:published_time" content="2020-03-20T10:53:05-05:00">
    <meta property="article:modified_time" content="2024-06-27T15:18:14-05:00">
    <meta itemprop="name" content="Game Screens :: K-State CIS 580 Textbook">
    <meta itemprop="description" content="XNA offered a sample building with these ideas that further organized a game into screens that has been ported to MonoGame.This was heavily influenced by Windows Phone, and includes gestures and “tombstoning” support. A more simplified form is presented here. It organizes a game into “screens”, each with its own logic and rendering, such as a menu, puzzle, cutscene, etc.
A scene manager game component manages a stack of these screens, and updates and renders the topmost.">
    <meta itemprop="datePublished" content="2020-03-20T10:53:05-05:00">
    <meta itemprop="dateModified" content="2024-06-27T15:18:14-05:00">
    <meta itemprop="wordCount" content="1837">
    <title>Game Screens :: K-State CIS 580 Textbook</title>
    <link href="https://textbooks.cs.ksu.edu/cis580/07-game-architecture/04-game-screens/" rel="canonical" type="text/html" title="Game Screens :: K-State CIS 580 Textbook">
    <link href="/cis580/07-game-architecture/04-game-screens/index.xml" rel="alternate" type="application/rss+xml" title="Game Screens :: K-State CIS 580 Textbook">
    <link href="/cis580/07-game-architecture/04-game-screens/index.print.html" rel="alternate" type="text/html" title="Game Screens :: K-State CIS 580 Textbook">
    <link href="/cis580/07-game-architecture/04-game-screens/embed.html" rel="alternate" type="text/html" title="Game Screens :: K-State CIS 580 Textbook">
    <link href="/cis580/css/fontawesome-all.min.css?1737133121" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/cis580/css/fontawesome-all.min.css?1737133121" rel="stylesheet"></noscript>
    <link href="/cis580/css/nucleus.css?1737133121" rel="stylesheet">
    <link href="/cis580/css/auto-complete.css?1737133121" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/cis580/css/auto-complete.css?1737133121" rel="stylesheet"></noscript>
    <link href="/cis580/css/perfect-scrollbar.min.css?1737133121" rel="stylesheet">
    <link href="/cis580/css/fonts.css?1737133121" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/cis580/css/fonts.css?1737133121" rel="stylesheet"></noscript>
    <link href="/cis580/css/theme.css?1737133121" rel="stylesheet">
    <link href="/cis580/css/theme-auto.css?1737133121" rel="stylesheet" id="R-variant-style">
    <link href="/cis580/css/chroma-auto.css?1737133121" rel="stylesheet" id="R-variant-chroma-style">
    <link href="/cis580/css/variant.css?1737133121" rel="stylesheet">
    <link href="/cis580/css/print.css?1737133121" rel="stylesheet" media="print">
    <script src="/cis580/js/variant.js?1737133121"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='..\/..';
      window.relearn.relBaseUri='..\/..\/..';
      window.relearn.absBaseUri='https:\/\/textbooks.cs.ksu.edu\/cis580';
      window.index_js_url="/cis580/index.search.js";
      // variant stuff
      window.variants && variants.init( [ 'auto', 'light-theme', 'dark-theme' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script>
    
    <link href="/cis580/css/custom.css?1737133121" rel="stylesheet">
  </head>
  <body class="mobile-support tele disableInlineCopyToClipboard" data-url="/cis580/07-game-architecture/04-game-screens/">
    
    <div id="tele" class="tele mirror">
    
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      
      
      
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>

<h1 id="game-screens">Game Screens</h1>

<p>XNA offered a sample building with these ideas that further organized a game into <em>screens</em> that has been <a href="https://github.com/tomizechsterson/game-state-management-monogame" rel="external" target="_blank">ported to MonoGame</a>.This was heavily influenced by Windows Phone, and includes gestures and &ldquo;tombstoning&rdquo; support.  A more simplified form is presented here.  It organizes a game into &ldquo;screens&rdquo;, each with its own logic and rendering, such as a menu, puzzle, cutscene, etc.</p>
<p>A scene manager game component manages a stack of these screens, and updates and renders the topmost.  Thus, from a gameplay screen, if we trigger a cutscene it would be pushed onto the stack, play, and then pop itself from the stack.  Similarly, pressing the &ldquo;menu&rdquo; button would push the menu screen onto the stack, leaving the player to interact with the menu instead of the game.  Screens manage their transition on and off this stack - and can incorporate visual effects into the transition.</p>
<h3 id="screenstate-enum">ScreenState Enum</h3>
<p>This enumeration represents the states a GameScreen can be in.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// Enumerations of the possible screen states</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">enum</span> <span class="n">ScreenState</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">TransitionOn</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">Active</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">TransitionOff</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">Hidden</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><h3 id="gamescreen">GameScreen</h3>
<p>The <code>GameScreen</code> class is an abstract base class that represents a single screen.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// A screen is a single layer of game content that has</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// its own update and draw logic and can be combined </span>
</span></span><span class="line"><span class="cl"><span class="cs">/// with other layers to create complex menus or game</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// experiences</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">abstract</span> <span class="k">class</span> <span class="nc">GameScreen</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Indicates if this screen is a popup</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;remarks&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Normally when a new screen is brought over another, </span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// the covered screen will transition off.  However, this</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// bool indicates the covering screen is only a popup, and </span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// the covered screen will remain partially visible</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/remarks&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">bool</span> <span class="n">IsPopup</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="kd">protected</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// The amount of time taken for this screen to transition on</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">protected</span> <span class="n">TimeSpan</span> <span class="n">TransitionOnTime</span> <span class="p">{</span><span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;}</span> <span class="p">=</span> <span class="n">TimeSpan</span><span class="p">.</span><span class="n">Zero</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// The amount of time taken for this screen to transition off</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">protected</span> <span class="n">TimeSpan</span> <span class="n">TransitionOffTime</span> <span class="p">{</span><span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;}</span> <span class="p">=</span> <span class="n">TimeSpan</span><span class="p">.</span><span class="n">Zero</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// The screen&#39;s position in the transition</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;value&gt;Ranges from 0 to 1 (fully on to fully off)&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">protected</span> <span class="kt">float</span> <span class="n">TransitionPosition</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// The alpha value based on the current transition position</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">float</span> <span class="n">TransitionAlpha</span> <span class="p">=&gt;</span> <span class="m">1f</span> <span class="p">-</span> <span class="n">TransitionPosition</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// The current state of the screen</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">ScreenState</span> <span class="n">ScreenState</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="n">ScreenState</span><span class="p">.</span><span class="n">TransitionOn</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Indicates the screen is exiting for good (not simply obscured)</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;remarks&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// There are two possible reasons why a screen might be transitioning</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// off. It could be temporarily going away to make room for another</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// screen that is on top of it, or it could be going away for good.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// This property indicates whether the screen is exiting for real:</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// if set, the screen will automatically remove itself as soon as the</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// transition finishes.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/remarks&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">bool</span> <span class="n">IsExiting</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="kd">protected</span> <span class="kd">internal</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Indicates if this screen is active</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">bool</span> <span class="n">IsActive</span> <span class="p">=&gt;</span> <span class="p">!</span><span class="n">_otherScreenHasFocus</span> <span class="p">&amp;&amp;</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">ScreenState</span> <span class="p">==</span> <span class="n">ScreenState</span><span class="p">.</span><span class="n">TransitionOn</span> <span class="p">||</span>
</span></span><span class="line"><span class="cl">        <span class="n">ScreenState</span> <span class="p">==</span> <span class="n">ScreenState</span><span class="p">.</span><span class="n">Active</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kt">bool</span> <span class="n">_otherScreenHasFocus</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// The ScreenManager in charge of this screen</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">ScreenManager</span> <span class="n">ScreenManager</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="kd">internal</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the index of the player who is currently controlling this screen,</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// or null if it is accepting input from any player. </span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;remarks&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// This is used to lock the game to a specific player profile. The main menu </span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// responds to input from any connected gamepad, but whichever player makes </span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// a selection from this menu is given control over all subsequent screens, </span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// so other gamepads are inactive until the controlling player returns to the </span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// main menu.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/remarks&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">PlayerIndex</span><span class="p">?</span> <span class="n">ControllingPlayer</span> <span class="p">{</span> <span class="kd">protected</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Activates the screen.  Called when the screen is added to the screen manager </span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// or the game returns from being paused.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">virtual</span> <span class="k">void</span> <span class="n">Activate</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Deactivates the screen.  Called when the screen is removed from the screen manager </span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// or when the game is paused.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">virtual</span> <span class="k">void</span> <span class="n">Deactivate</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Unloads content for the screen. Called when the screen is removed from the screen manager</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">virtual</span> <span class="k">void</span> <span class="n">Unload</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Updates the screen. Unlike HandleInput, this method is called regardless of whether the screen</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// is active, hidden, or in the middle of a transition.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">virtual</span> <span class="k">void</span> <span class="n">Update</span><span class="p">(</span><span class="n">GameTime</span> <span class="n">gameTime</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">otherScreenHasFocus</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">coveredByOtherScreen</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">_otherScreenHasFocus</span> <span class="p">=</span> <span class="n">otherScreenHasFocus</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">IsExiting</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// If the screen is going away forever, it should transition off</span>
</span></span><span class="line"><span class="cl">            <span class="n">ScreenState</span> <span class="p">=</span> <span class="n">ScreenState</span><span class="p">.</span><span class="n">TransitionOff</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(!</span><span class="n">UpdateTransitionPosition</span><span class="p">(</span><span class="n">gameTime</span><span class="p">,</span> <span class="n">TransitionOffTime</span><span class="p">,</span> <span class="m">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="n">ScreenManager</span><span class="p">.</span><span class="n">RemoveScreen</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">coveredByOtherScreen</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// if the screen is covered by another, it should transition off</span>
</span></span><span class="line"><span class="cl">            <span class="n">ScreenState</span> <span class="p">=</span> <span class="n">UpdateTransitionPosition</span><span class="p">(</span><span class="n">gameTime</span><span class="p">,</span> <span class="n">TransitionOffTime</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">?</span> <span class="n">ScreenState</span><span class="p">.</span><span class="n">TransitionOff</span>
</span></span><span class="line"><span class="cl">                <span class="p">:</span> <span class="n">ScreenState</span><span class="p">.</span><span class="n">Hidden</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Otherwise the screen should transition on and become active.</span>
</span></span><span class="line"><span class="cl">            <span class="n">ScreenState</span> <span class="p">=</span> <span class="n">UpdateTransitionPosition</span><span class="p">(</span><span class="n">gameTime</span><span class="p">,</span> <span class="n">TransitionOnTime</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">?</span> <span class="n">ScreenState</span><span class="p">.</span><span class="n">TransitionOn</span>
</span></span><span class="line"><span class="cl">                <span class="p">:</span> <span class="n">ScreenState</span><span class="p">.</span><span class="n">Active</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Updates the TransitionPosition property based on the time</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;gameTime&#34;&gt;an object representing time in the game&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;time&#34;&gt;The amount of time the transition should take&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;direction&#34;&gt;The direction of the transition&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;returns&gt;true if still transitioning, false if the transition is done&lt;/returns&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kt">bool</span> <span class="n">UpdateTransitionPosition</span><span class="p">(</span><span class="n">GameTime</span> <span class="n">gameTime</span><span class="p">,</span> <span class="n">TimeSpan</span> <span class="n">time</span><span class="p">,</span> <span class="kt">int</span> <span class="n">direction</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// How much should we move by?</span>
</span></span><span class="line"><span class="cl">        <span class="kt">float</span> <span class="n">transitionDelta</span> <span class="p">=</span> <span class="p">(</span><span class="n">time</span> <span class="p">==</span> <span class="n">TimeSpan</span><span class="p">.</span><span class="n">Zero</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">?</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl">            <span class="p">:</span> <span class="p">(</span><span class="kt">float</span><span class="p">)(</span><span class="n">gameTime</span><span class="p">.</span><span class="n">ElapsedGameTime</span><span class="p">.</span><span class="n">TotalMilliseconds</span> <span class="p">/</span> <span class="n">time</span><span class="p">.</span><span class="n">TotalMilliseconds</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Update the transition time</span>
</span></span><span class="line"><span class="cl">        <span class="n">TransitionPosition</span> <span class="p">+=</span> <span class="n">transitionDelta</span> <span class="p">*</span> <span class="n">direction</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Did we reach the end of the transition?</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">direction</span> <span class="p">&lt;</span> <span class="m">0</span> <span class="p">&amp;&amp;</span> <span class="n">TransitionPosition</span> <span class="p">&lt;=</span> <span class="m">0</span> <span class="p">||</span> <span class="n">direction</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">&amp;&amp;</span> <span class="n">TransitionPosition</span> <span class="p">&gt;=</span> <span class="m">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">TransitionPosition</span> <span class="p">=</span> <span class="n">MathHelper</span><span class="p">.</span><span class="n">Clamp</span><span class="p">(</span><span class="n">TransitionPosition</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// if not, we are still transitioning</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Handles input for this screen.  Only called when the screen is active,</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// and not when another screen has taken focus.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;gameTime&#34;&gt;An object representing time in the game&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;input&#34;&gt;An object representing input&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">virtual</span> <span class="k">void</span> <span class="n">HandleInput</span><span class="p">(</span><span class="n">GameTime</span> <span class="n">gameTime</span><span class="p">,</span> <span class="n">InputState</span> <span class="n">input</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Draws the GameScreen.  Only called with the screen is active, and not </span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// when another screen has taken the focus.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;gameTime&#34;&gt;An object representing time in the game&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">virtual</span> <span class="k">void</span> <span class="n">Draw</span><span class="p">(</span><span class="n">GameTime</span> <span class="n">gameTime</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// This method tells the screen to exit, allowing it time to transition off</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">void</span> <span class="n">ExitScreen</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">TransitionOffTime</span> <span class="p">==</span> <span class="n">TimeSpan</span><span class="p">.</span><span class="n">Zero</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">ScreenManager</span><span class="p">.</span><span class="n">RemoveScreen</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>    <span class="c1">// If the screen has a zero transition time, remove it immediately</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="n">IsExiting</span> <span class="p">=</span> <span class="kc">true</span><span class="p">;</span>    <span class="c1">// Otherwise flag that it should transition off and then exit.</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><h4 id="screenmanager">ScreenManager</h4>
<p>The <code>ScreenManager</code> class manages the screens, updating and drawing only when appropriate.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// The ScreenManager is a component which manages one or more GameScreen instance.</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// It maintains a stack of screens, calls their Update and Draw methods when </span>
</span></span><span class="line"><span class="cl"><span class="cs">/// appropriate, and automatically routes input to the topmost screen.</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="k">class</span> <span class="nc">ScreenManager</span> <span class="p">:</span> <span class="n">DrawableGameComponent</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="k">readonly</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">GameScreen</span><span class="p">&gt;</span> <span class="n">_screens</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">GameScreen</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="k">readonly</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">GameScreen</span><span class="p">&gt;</span> <span class="n">_tmpScreensList</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">GameScreen</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="k">readonly</span> <span class="n">ContentManager</span> <span class="n">_content</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="k">readonly</span> <span class="n">InputState</span> <span class="n">_input</span> <span class="p">=</span> <span class="k">new</span> <span class="n">InputState</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kt">bool</span> <span class="n">_isInitialized</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// A SpriteBatch shared by all GameScreens</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">SpriteBatch</span> <span class="n">SpriteBatch</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="kd">private</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// A SpriteFont shared by all GameScreens</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">SpriteFont</span> <span class="n">MenuFont</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="kd">private</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Constructs a new ScreenManager</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;game&#34;&gt;The game this ScreenManager belongs to&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">ScreenManager</span><span class="p">(</span><span class="n">Game</span> <span class="n">game</span><span class="p">)</span> <span class="p">:</span> <span class="k">base</span><span class="p">(</span><span class="n">game</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">_content</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ContentManager</span><span class="p">(</span><span class="n">game</span><span class="p">.</span><span class="n">Services</span><span class="p">,</span> <span class="s">&#34;Content&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Initializes the ScreenManager</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">override</span> <span class="k">void</span> <span class="n">Initialize</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">base</span><span class="p">.</span><span class="n">Initialize</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">_isInitialized</span> <span class="p">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Loads content for the ScreenManager and its screens</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">protected</span> <span class="kd">override</span> <span class="k">void</span> <span class="n">LoadContent</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">SpriteBatch</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SpriteBatch</span><span class="p">(</span><span class="n">GraphicsDevice</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">MenuFont</span> <span class="p">=</span> <span class="n">_content</span><span class="p">.</span><span class="n">Load</span><span class="p">&lt;</span><span class="n">SpriteFont</span><span class="p">&gt;(</span><span class="s">&#34;MenuFont&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Tell each of the screens to load thier content </span>
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span><span class="p">(</span><span class="kt">var</span> <span class="n">screen</span> <span class="k">in</span> <span class="n">_screens</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">screen</span><span class="p">.</span><span class="n">Activate</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Unloads content for the ScreenManager&#39;s screens</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">protected</span> <span class="kd">override</span> <span class="k">void</span> <span class="n">UnloadContent</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span><span class="p">(</span><span class="kt">var</span> <span class="n">screen</span> <span class="k">in</span> <span class="n">_screens</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">screen</span><span class="p">.</span><span class="n">Unload</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Updates all screens managed by the ScreenManager</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;gameTime&#34;&gt;An object representing time in the game&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">override</span> <span class="k">void</span> <span class="n">Update</span><span class="p">(</span><span class="n">GameTime</span> <span class="n">gameTime</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Read in the keyboard and gamepad</span>
</span></span><span class="line"><span class="cl">        <span class="n">_input</span><span class="p">.</span><span class="n">Update</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Make a copy of the screen list, to avoid confusion if </span>
</span></span><span class="line"><span class="cl">        <span class="c1">// the process of updating a screen adds or removes others</span>
</span></span><span class="line"><span class="cl">        <span class="n">_tmpScreensList</span><span class="p">.</span><span class="n">Clear</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">_tmpScreensList</span><span class="p">.</span><span class="n">AddRange</span><span class="p">(</span><span class="n">_screens</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kt">bool</span> <span class="n">otherScreenHasFocus</span> <span class="p">=</span> <span class="p">!</span><span class="n">Game</span><span class="p">.</span><span class="n">IsActive</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kt">bool</span> <span class="n">coveredByOtherScreen</span> <span class="p">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">while</span><span class="p">(</span><span class="n">_tmpScreensList</span><span class="p">.</span><span class="n">Count</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Pop the topmost screen </span>
</span></span><span class="line"><span class="cl">            <span class="kt">var</span> <span class="n">screen</span> <span class="p">=</span> <span class="n">_tmpScreensList</span><span class="p">[</span><span class="n">_tmpScreensList</span><span class="p">.</span><span class="n">Count</span> <span class="p">-</span> <span class="m">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">            <span class="n">_tmpScreensList</span><span class="p">.</span><span class="n">RemoveAt</span><span class="p">(</span><span class="n">_tmpScreensList</span><span class="p">.</span><span class="n">Count</span> <span class="p">-</span> <span class="m">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">screen</span><span class="p">.</span><span class="n">Update</span><span class="p">(</span><span class="n">gameTime</span><span class="p">,</span> <span class="n">otherScreenHasFocus</span><span class="p">,</span> <span class="n">coveredByOtherScreen</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">screen</span><span class="p">.</span><span class="n">ScreenState</span> <span class="p">==</span> <span class="n">ScreenState</span><span class="p">.</span><span class="n">TransitionOn</span> <span class="p">||</span> <span class="n">screen</span><span class="p">.</span><span class="n">ScreenState</span> <span class="p">==</span> <span class="n">ScreenState</span><span class="p">.</span><span class="n">Active</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// if this is the first active screen, let it handle input </span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(!</span><span class="n">otherScreenHasFocus</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">screen</span><span class="p">.</span><span class="n">HandleInput</span><span class="p">(</span><span class="n">gameTime</span><span class="p">,</span> <span class="n">_input</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">otherScreenHasFocus</span> <span class="p">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="c1">// if this is an active non-popup, all subsequent </span>
</span></span><span class="line"><span class="cl">                <span class="c1">// screens are covered </span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(!</span><span class="n">screen</span><span class="p">.</span><span class="n">IsPopup</span><span class="p">)</span> <span class="n">coveredByOtherScreen</span> <span class="p">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Draws the appropriate screens managed by the SceneManager</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;gameTime&#34;&gt;An object representing time in the game&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">override</span> <span class="k">void</span> <span class="n">Draw</span><span class="p">(</span><span class="n">GameTime</span> <span class="n">gameTime</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span><span class="p">(</span><span class="kt">var</span> <span class="n">screen</span> <span class="k">in</span> <span class="n">_screens</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">screen</span><span class="p">.</span><span class="n">ScreenState</span> <span class="p">==</span> <span class="n">ScreenState</span><span class="p">.</span><span class="n">Hidden</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">screen</span><span class="p">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">gameTime</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Adds a screen to the ScreenManager</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;screen&#34;&gt;The screen to add&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">void</span> <span class="n">AddScreen</span><span class="p">(</span><span class="n">GameScreen</span> <span class="n">screen</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">screen</span><span class="p">.</span><span class="n">ScreenManager</span> <span class="p">=</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">screen</span><span class="p">.</span><span class="n">IsExiting</span> <span class="p">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// If we have a graphics device, tell the screen to load content</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">_isInitialized</span><span class="p">)</span> <span class="n">screen</span><span class="p">.</span><span class="n">Activate</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">_screens</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">screen</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">void</span> <span class="n">RemoveScreen</span><span class="p">(</span><span class="n">GameScreen</span> <span class="n">screen</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// If we have a graphics device, tell the screen to unload its content </span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">_isInitialized</span><span class="p">)</span> <span class="n">screen</span><span class="p">.</span><span class="n">Unload</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">_screens</span><span class="p">.</span><span class="n">Remove</span><span class="p">(</span><span class="n">screen</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">_tmpScreensList</span><span class="p">.</span><span class="n">Remove</span><span class="p">(</span><span class="n">screen</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Exposes an array holding all the screens managed by the ScreenManager</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;returns&gt;An array containing references to all current screens&lt;/returns&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">GameScreen</span><span class="p">[]</span> <span class="n">GetScreens</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">_screens</span><span class="p">.</span><span class="n">ToArray</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><h3 id="other-changes">Other Changes</h3>
<p>This sample also uses the <code>InputState</code> class <a href="https://textbooks.cs.ksu.edu/cis580/02-player-input/07-input-state/" rel="external" target="_blank">introduced in chapter 7</a>.  In your game class, you need to create the <code>ScreenManager</code>, and then add your custom screen classes, which can be done in your constructor or <code>Initialize()</code> method:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl"><span class="kt">var</span> <span class="n">screenManager</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ScreenManager</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">screenManager</span><span class="p">.</span><span class="n">AddScreen</span><span class="p">(</span><span class="k">new</span> <span class="n">ExampleScreenA</span><span class="p">());</span>
</span></span><span class="line"><span class="cl"><span class="n">screenManager</span><span class="p">.</span><span class="n">AddScreen</span><span class="p">(</span><span class="k">new</span> <span class="n">ExampleScreenB</span><span class="p">());</span>
</span></span><span class="line"><span class="cl"><span class="p">...</span></span></span></code></pre></div><p>Once added, the screen&rsquo;s <code>Initialize</code>, <code>LoadContent()</code>, <code>Update()</code>, and <code>Draw()</code> methods will all be invoked automatically as appropriate by the <code>Game</code> class.</p>
<p>It might also make sense to register the <code>ScreenManager</code> as a service, especially if you expect to add additional screens as the game is running:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl"><span class="c1">// From within your Game class</span>
</span></span><span class="line"><span class="cl"><span class="k">this</span><span class="p">.</span><span class="n">Services</span><span class="p">.</span><span class="n">AddService</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">ScreenManager</span><span class="p">),</span> <span class="n">screenManager</span><span class="p">);</span></span></span></code></pre></div><p>Screens can be added at any time, which pushes them to the top of the stack - a common use would be to open a menu or submenu.</p>
<p>You can also stack as many screens as you like at the start of the game - you might arrange a multilevel game this way:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl"><span class="n">screenManager</span><span class="p">.</span><span class="n">AddScreen</span><span class="p">(</span><span class="k">new</span> <span class="n">CreditsScreen</span><span class="p">());</span>
</span></span><span class="line"><span class="cl"><span class="n">screenManager</span><span class="p">.</span><span class="n">AddScreen</span><span class="p">(</span><span class="k">new</span> <span class="n">Level8Screen</span><span class="p">());</span>
</span></span><span class="line"><span class="cl"><span class="n">screenManager</span><span class="p">.</span><span class="n">AddScreen</span><span class="p">(</span><span class="k">new</span> <span class="n">Level7Screen</span><span class="p">());</span>
</span></span><span class="line"><span class="cl"><span class="n">screenManager</span><span class="p">.</span><span class="n">AddScreen</span><span class="p">(</span><span class="k">new</span> <span class="n">Level6Screen</span><span class="p">());</span>
</span></span><span class="line"><span class="cl"><span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="n">screenManager</span><span class="p">.</span><span class="n">AddScreen</span><span class="p">(</span><span class="k">new</span> <span class="n">Level1Screen</span><span class="p">());</span>
</span></span><span class="line"><span class="cl"><span class="n">screenManager</span><span class="p">.</span><span class="n">AddScreen</span><span class="p">(</span><span class="k">new</span> <span class="n">OpeningScreen</span><span class="p">());</span></span></span></code></pre></div><p>And invoke each screen&rsquo;s <code>ExitScreen()</code> when the level is completed.</p>

            <footer class="footline">
              
              
              
              
            </footer>
          </article>
</div>
</main>
</div>

</div>




<script src="/cis580/js/clipboard.min.js?1737133121" defer></script>
<script src="/cis580/js/perfect-scrollbar.min.js?1737133121" defer></script>
<script src="/cis580/js/theme.js?1737133121" defer></script>

<script src="/cis580/js/tele-scroll.js?1737133121" defer></script>

</body>
</html>
