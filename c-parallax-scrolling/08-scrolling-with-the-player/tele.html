




  
	
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
	  

  
	
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
	  

  
	
		
		
<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.128.0">
    <meta name="generator" content="Relearn 6.0.0">
    <meta name="description" content="One of the benefits of the IScrollController interface is that we can swap out the default controller for a new one. Let’s do so now.
Player Tracking ScrollController A second common implementation of parallax scrolling is one where the screen scrolls as the player moves. Let’s implement this one by defining a new controller named PlayerTrackingScrollController that follows our player. The class will need to implement the IScrollController interface:
/// &lt;summary&gt; /// A parallax scroll controller that tracks a player&#39;s position.">
    <meta name="author" content="Nathan Bean">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Scrolling With the Player :: K-State CIS 580 Textbook">
    <meta name="twitter:description" content="One of the benefits of the IScrollController interface is that we can swap out the default controller for a new one. Let’s do so now.
Player Tracking ScrollController A second common implementation of parallax scrolling is one where the screen scrolls as the player moves. Let’s implement this one by defining a new controller named PlayerTrackingScrollController that follows our player. The class will need to implement the IScrollController interface:
/// &lt;summary&gt; /// A parallax scroll controller that tracks a player&#39;s position.">
    <meta property="og:url" content="https://textbooks.cs.ksu.edu/cis580/c-parallax-scrolling/08-scrolling-with-the-player/">
    <meta property="og:site_name" content="K-State CIS 580 Textbook">
    <meta property="og:title" content="Scrolling With the Player :: K-State CIS 580 Textbook">
    <meta property="og:description" content="One of the benefits of the IScrollController interface is that we can swap out the default controller for a new one. Let’s do so now.
Player Tracking ScrollController A second common implementation of parallax scrolling is one where the screen scrolls as the player moves. Let’s implement this one by defining a new controller named PlayerTrackingScrollController that follows our player. The class will need to implement the IScrollController interface:
/// &lt;summary&gt; /// A parallax scroll controller that tracks a player&#39;s position.">
    <meta property="og:locale" content="en-us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Parallax Scrolling">
    <meta property="article:published_time" content="2020-03-24T10:00:00-05:00">
    <meta property="article:modified_time" content="2021-03-11T13:44:31-06:00">
    <meta itemprop="name" content="Scrolling With the Player :: K-State CIS 580 Textbook">
    <meta itemprop="description" content="One of the benefits of the IScrollController interface is that we can swap out the default controller for a new one. Let’s do so now.
Player Tracking ScrollController A second common implementation of parallax scrolling is one where the screen scrolls as the player moves. Let’s implement this one by defining a new controller named PlayerTrackingScrollController that follows our player. The class will need to implement the IScrollController interface:
/// &lt;summary&gt; /// A parallax scroll controller that tracks a player&#39;s position.">
    <meta itemprop="datePublished" content="2020-03-24T10:00:00-05:00">
    <meta itemprop="dateModified" content="2021-03-11T13:44:31-06:00">
    <meta itemprop="wordCount" content="573">
    <title>Scrolling With the Player :: K-State CIS 580 Textbook</title>
    <link href="https://textbooks.cs.ksu.edu/cis580/c-parallax-scrolling/08-scrolling-with-the-player/" rel="canonical" type="text/html" title="Scrolling With the Player :: K-State CIS 580 Textbook">
    <link href="/cis580/c-parallax-scrolling/08-scrolling-with-the-player/index.xml" rel="alternate" type="application/rss+xml" title="Scrolling With the Player :: K-State CIS 580 Textbook">
    <link href="/cis580/c-parallax-scrolling/08-scrolling-with-the-player/index.print.html" rel="alternate" type="text/html" title="Scrolling With the Player :: K-State CIS 580 Textbook">
    <link href="/cis580/c-parallax-scrolling/08-scrolling-with-the-player/embed.html" rel="alternate" type="text/html" title="Scrolling With the Player :: K-State CIS 580 Textbook">
    <link href="/cis580/css/fontawesome-all.min.css?1723670681" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/cis580/css/fontawesome-all.min.css?1723670681" rel="stylesheet"></noscript>
    <link href="/cis580/css/nucleus.css?1723670681" rel="stylesheet">
    <link href="/cis580/css/auto-complete.css?1723670681" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/cis580/css/auto-complete.css?1723670681" rel="stylesheet"></noscript>
    <link href="/cis580/css/perfect-scrollbar.min.css?1723670681" rel="stylesheet">
    <link href="/cis580/css/fonts.css?1723670681" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/cis580/css/fonts.css?1723670681" rel="stylesheet"></noscript>
    <link href="/cis580/css/theme.css?1723670681" rel="stylesheet">
    <link href="/cis580/css/theme-auto.css?1723670681" rel="stylesheet" id="R-variant-style">
    <link href="/cis580/css/chroma-auto.css?1723670681" rel="stylesheet" id="R-variant-chroma-style">
    <link href="/cis580/css/variant.css?1723670681" rel="stylesheet">
    <link href="/cis580/css/print.css?1723670681" rel="stylesheet" media="print">
    <script src="/cis580/js/variant.js?1723670681"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='..\/..';
      window.relearn.relBaseUri='..\/..\/..';
      window.relearn.absBaseUri='https:\/\/textbooks.cs.ksu.edu\/cis580';
      window.index_js_url="/cis580/index.search.js";
      // variant stuff
      window.variants && variants.init( [ 'auto', 'light-theme', 'dark-theme' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script>
    
    <link href="/cis580/css/custom.css?1723670681" rel="stylesheet">
  </head>
  <body class="mobile-support tele disableInlineCopyToClipboard" data-url="/cis580/c-parallax-scrolling/08-scrolling-with-the-player/">
    
    <div id="tele" class="tele mirror">
    
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      
      
      
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>

<h1 id="scrolling-with-the-player">Scrolling With the Player</h1>

<p>One of the benefits of the <code>IScrollController</code> interface is that we can swap out the default controller for a new one.  Let&rsquo;s do so now.</p>
<h2 id="player-tracking-scrollcontroller">Player Tracking ScrollController</h2>
<p>A second common implementation of parallax scrolling is one where the screen scrolls as the player moves.  Let&rsquo;s implement this one by defining a new controller named <code>PlayerTrackingScrollController</code> that follows our player.  The class will need to implement the <code>IScrollController</code> interface:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// A parallax scroll controller that tracks a player&#39;s position.</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="k">class</span> <span class="nc">PlayerTrackingScrollController</span> <span class="p">:</span> <span class="n">IScrollController</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><p>We&rsquo;ll need to have a reference to the player we are tracking:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// The Player to track</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Player</span> <span class="n">player</span><span class="p">;</span></span></span></code></pre></div><p>And a ratio defining how much the screen should scroll in relation to the player&rsquo;s position.  We can think of this as a percentage, expressed as a float between 0 and 1 (where 0 is 0% and 1 is 100%).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// How much the parallax layer should scroll relative to the player position</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Should probably be a number between 0 and 1, corresponding to 0% to 100%.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">float</span> <span class="n">ScrollRatio</span> <span class="p">=</span> <span class="m">1.0f</span><span class="p">;</span></span></span></code></pre></div><p>We might also define an offset to add space between the player&rsquo;s position and the edge of the screen.  Currently our helicopter is at &lt;200, 200&gt;, so let&rsquo;s use 200:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// The offset between the scrolling layer and the player</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">float</span> <span class="n">Offset</span> <span class="p">=</span> <span class="m">200</span><span class="p">;</span></span></span></code></pre></div><p>Now we need to implement the requirements of the <code>IScrollController</code> interface.  The first of these is the <code>Transform</code> property, which needs a getter.  We can create a translation matrix that scrolls the screen by subtracting the player position from the offset, and multiplying that quantity by the scroll ratio:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Gets the transformation matrix to use with the layer</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">Matrix</span> <span class="n">Transform</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">get</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">float</span> <span class="n">x</span> <span class="p">=</span> <span class="n">ScrollRatio</span> <span class="p">*</span> <span class="p">(</span><span class="n">Offset</span> <span class="p">-</span> <span class="n">player</span><span class="p">.</span><span class="n">Position</span><span class="p">.</span><span class="n">X</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">Matrix</span><span class="p">.</span><span class="n">CreateTranslation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span></span></span></code></pre></div><p>And we&rsquo;ll need to implement the required <code>Update()</code> method as well.  Since we already create the matrix in the <code>Transform</code> getter, there is nothing for this method to do:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="c1">// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Updates the controller (a no-op in this case)</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;gameTime&#34;&gt;&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">void</span> <span class="n">Update</span><span class="p">(</span><span class="n">GameTime</span> <span class="n">gameTime</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span></span></span></code></pre></div><p>Finally, we can write a constructor to supply the player and scroll ratio:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Constructs a new PlayerTrackingScrollController</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;player&#34;&gt;The player to track&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;ratio&#34;&gt;The scroll ratio for the controlled layer&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">PlayerTrackingScrollController</span><span class="p">(</span><span class="n">Player</span> <span class="n">player</span><span class="p">,</span> <span class="kt">float</span> <span class="n">ratio</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="n">player</span> <span class="p">=</span> <span class="n">player</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="n">ScrollRatio</span> <span class="p">=</span> <span class="n">ratio</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>   </span></span></code></pre></div><h2 id="refactoring-game1">Refactoring Game1</h2>
<p>To use our new <code>PlayerTrackingScrollController</code>, we&rsquo;ll need to refactor <code>Game1</code> slightly.  First, we&rsquo;ll need to create and apply instances of the <code>PlayerTrackingScrollController</code> to all of our layers.  This can be done in our <code>Game1.LoadContent()</code> method after both the player and layers are created:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">     <span class="n">backgroundLayer</span><span class="p">.</span><span class="n">ScrollController</span> <span class="p">=</span> <span class="k">new</span> <span class="n">PlayerTrackingScrollController</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="m">0.1f</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">midgroundLayer</span><span class="p">.</span><span class="n">ScrollController</span> <span class="p">=</span> <span class="k">new</span> <span class="n">PlayerTrackingScrollController</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="m">0.4f</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">playerLayer</span><span class="p">.</span><span class="n">ScrollController</span> <span class="p">=</span> <span class="k">new</span> <span class="n">PlayerTrackingScrollController</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="m">1.0f</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">foregroundLayer</span><span class="p">.</span><span class="n">ScrollController</span> <span class="p">=</span> <span class="k">new</span> <span class="n">PlayerTrackingScrollController</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="m">1.0f</span><span class="p">);</span></span></span></code></pre></div><p>We want to scroll the background the slowest, while the player layer should scroll <em>exactly</em> the same amount the player moves.</p>
<p>We also need to remove or comment out the lines setting the <code>AutoScrollController.Speed</code> property, as our layers are no longer using that type of controller.  Remove or comment out the lines:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl">    <span class="kt">var</span> <span class="n">midgroundScrollController</span> <span class="p">=</span> <span class="n">midgroundLayer</span><span class="p">.</span><span class="n">ScrollController</span> <span class="k">as</span> <span class="n">AutoScrollController</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">midgroundScrollController</span><span class="p">.</span><span class="n">Speed</span> <span class="p">=</span> <span class="m">40f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kt">var</span> <span class="n">foregroundScrollController</span> <span class="p">=</span> <span class="n">foregroundLayer</span><span class="p">.</span><span class="n">ScrollController</span> <span class="k">as</span> <span class="n">AutoScrollController</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">foregroundScrollController</span><span class="p">.</span><span class="n">Speed</span> <span class="p">=</span> <span class="m">80f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kt">var</span> <span class="n">playerScrollController</span> <span class="p">=</span> <span class="n">playerLayer</span><span class="p">.</span><span class="n">ScrollController</span> <span class="k">as</span> <span class="n">AutoScrollController</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">playerScrollController</span><span class="p">.</span><span class="n">Speed</span> <span class="p">=</span> <span class="m">80f</span><span class="p">;</span></span></span></code></pre></div><p>Now if you run the program, the layers scroll only when the helicopter moves!</p>

            <footer class="footline">
              
              
              
              
            </footer>
          </article>
</div>
</main>
</div>

</div>




<script src="/cis580/js/clipboard.min.js?1723670681" defer></script>
<script src="/cis580/js/perfect-scrollbar.min.js?1723670681" defer></script>
<script src="/cis580/js/theme.js?1723670681" defer></script>

<script src="/cis580/js/tele-scroll.js?1723670681" defer></script>

</body>
</html>
