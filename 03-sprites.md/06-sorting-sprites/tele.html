




	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.117.0">
    <meta name="generator" content="Relearn 5.18.0">
    <meta name="description" content="K-State CIS 580 Textbook">
    <meta name="author" content="Nathan H. Bean">
    <title>Sorting Sprites :: K-State CIS 580 Textbook</title>
    <link href="https://ksu-cs-textbooks.github.io/cis580/03-sprites.md/06-sorting-sprites/index.html" rel="canonical" type="text/html" title="Sorting Sprites :: K-State CIS 580 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis580/03-sprites.md/06-sorting-sprites/index.xml" rel="alternate" type="application/rss+xml" title="Sorting Sprites :: K-State CIS 580 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis580/03-sprites.md/06-sorting-sprites/index.print.html" rel="alternate" type="text/html" title="Sorting Sprites :: K-State CIS 580 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis580/03-sprites.md/06-sorting-sprites/embed.html" rel="alternate" type="text/html" title="Sorting Sprites :: K-State CIS 580 Textbook">
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/fontawesome-all.min.css?1691771333" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis580/css/fontawesome-all.min.css?1691771333" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/nucleus.css?1691771333" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/auto-complete.css?1691771333" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis580/css/auto-complete.css?1691771333" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/perfect-scrollbar.min.css?1691771333" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/fonts.css?1691771333" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis580/css/fonts.css?1691771333" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/theme.css?1691771333" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/theme-auto.css?1691771333" rel="stylesheet" id="variant-style">
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/variant.css?1691771333" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/print.css?1691771333" rel="stylesheet" media="print">
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/ie.css?1691771333" rel="stylesheet">
    <script src="https://ksu-cs-textbooks.github.io/cis580/js/url.js?1691771333"></script>
    <script src="https://ksu-cs-textbooks.github.io/cis580/js/variant.js?1691771333"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="https://ksu-cs-textbooks.github.io/cis580/index.search.js";
      var root_url="https://ksu-cs-textbooks.github.io/cis580/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      window.T_No_results_found = 'No results found for \u0022{0}\u0022';
      window.T_N_results_found = '{1} results found for \u0022{0}\u0022';
      // some further base stuff
      var baseUriFull='https:\/\/ksu-cs-textbooks.github.io\/cis580/';
      window.variants && variants.init( [ 'auto', 'light-theme', 'dark-theme' ] );
    </script>
    
    <link href="https://ksu-cs-textbooks.github.io/cis580/css/custom.css?1691771333" rel="stylesheet">

  </head>
  <body class="mobile-support tele disableInlineCopyToClipboard" data-url="https://ksu-cs-textbooks.github.io/cis580/03-sprites.md/06-sorting-sprites/index.html">
    
    <div id="tele" class="tele mirror">
    
    <div id="body" class="default-animation">
      
      
      
      <main id="body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>
<h1 id="sorting-sprites">Sorting Sprites</h1>

<p>When drawing sprites, we often refer to the <a href="https://en.wikipedia.org/wiki/Painter%27s_algorithm" target="_blank">Painter&rsquo;s Algorithm</a>
.  This algorithm simply involves drawing the most distant part of the scene <em>first</em> (i.e. background elements) before drawing the closer elements.  This way the closer elements are drawn <em>on top of</em> the elements behind them, as when we draw we are literally copying over the existing pixel color values.</p>
<p>This is even more important when working with <em>translucent</em> (partially transparent) sprites, as we mix the translucent color with the color(s) of the elements underneath the translucent sprite.  If those colors have not yet been set, this blending will not happen.</p>
<p>The <code>SpriteBatch</code> assumes that we batch sprites in the order we want them drawn, i.e. the most distant sprites should have their <code>Draw()</code> calls first.  For many games, this is simple to accomplish, but there are some where it becomes significantly challenging (i.e. tilemap games where some tiles are &ldquo;above&rdquo; the background layer).  For these games, we can utilize the <code>SpriteBatch</code>&rsquo;s built-in sorting.</p>
<p>This is activated by calling <code>SpriteBatch.Begin(SpriteSortMode.BackToFront)</code> instead of <code>SpriteBatch.Begin()</code>.  This replaces the default sorting mode, <code>SpriteSortMode.Deferred</code> with the back-to-front sorting, based on the <code>depthLayer</code> specified in the sprite&rsquo;s <code>Draw()</code> call.  When using this mode, the <code>SpriteBatch</code> sorts the sprites immediately before it renders them.</p>
<p>A couple of things to remember about this sorting:</p>
<ol>
<li>It is more efficient if the sprites are for the most part batched in the order they need to be drawn (as there is less rearranging to do)</li>
<li>The sorting order is not assured to be the same from frame-to-frame for sprites with the same <code>depthLayer</code> value.</li>
</ol>
<p>There is also a <code>SpriteSortMode.FrontToBack</code> mode that sorts sprites in the opposite order.  It can be helpful when your game specifies the <code>depthLayer</code> values opposite the expected order (larger numbers to the back).</p>
<p>In addition to these depth-sorting options, there is a <code>SpriteSortMode.Immediate</code> which, instead of batching the sprites draws them <em>immediately</em> when the <code>Draw()</code> call is made.  This can be less efficient as it requires the sprite drawing effect (a shader program) to be loaded into the graphics card for each sprite (rather than once for all sprites).</p>
<p>Finally, there is a <code>SpriteSortMode.Texture</code> option that orders sprites by their source texture.  As swapping textures is an expensive operation for the graphics card, arranging all sprites that use each texture to be drawn together can result in better efficiency.  However, this approach can make layered sprites be drawn out-of-order.  Thus, when possible it is better to use texture atlases to minimize texture swaps.</p>
<p>The <code>SpriteBatch.Begin()</code> has additional settings that can be overridden - we&rsquo;ll examine some of these in the lessons to come.</p>

            <footer class="footline">

            </footer>
          </article>
        </div>
      </main>
    </div>
    
    </div>
    
    
    
    
    <script src="https://ksu-cs-textbooks.github.io/cis580/js/clipboard.min.js?1691771333" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cis580/js/perfect-scrollbar.min.js?1691771333" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cis580/js/theme.js?1691771333" defer></script>
    
    <script src="https://ksu-cs-textbooks.github.io/cis580/js/tele-scroll.js?1691771333 defer"></script>
    
  </body>
</html>
